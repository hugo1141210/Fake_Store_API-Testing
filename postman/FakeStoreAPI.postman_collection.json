{
	"info": {
		"_postman_id": "4b5b854b-e14b-4dde-a77e-3152c24d1960",
		"name": "FakeStoreAPI",
		"description": "A free fake API for testing and prototyping e-commerce applications.\n\nContact Support:  \nEmail: [support@fakestoreapi.com](https://mailto:support@fakestoreapi.com)",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "51053559",
		"_collection_link": "https://hugo1141210-6162544.postman.co/workspace/354f2e5f-2c37-4eda-806d-c54a3af966be/collection/51053559-4b5b854b-e14b-4dde-a77e-3152c24d1960?action=share&source=collection_link&creator=51053559"
	},
	"item": [
		{
			"name": "01_Products",
			"item": [
				{
					"name": "TC-001 | GET /products | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Response is a non-empty array\", () => {\r",
									"  const data = pm.response.json();\r",
									"  pm.expect(data).to.be.an(\"array\");\r",
									"  pm.expect(data.length).to.be.above(0);\r",
									"});\r",
									"\r",
									"pm.test(\"Product schema contains required fields\", () => {\r",
									"  const item = pm.response.json()[0];\r",
									"\r",
									"  pm.expect(item).to.have.property(\"id\").that.is.a(\"number\");\r",
									"  pm.expect(item).to.have.property(\"title\").that.is.a(\"string\");\r",
									"  pm.expect(item).to.have.property(\"price\").that.is.a(\"number\");\r",
									"  pm.expect(item).to.have.property(\"description\").that.is.a(\"string\");\r",
									"  pm.expect(item).to.have.property(\"category\").that.is.a(\"string\");\r",
									"  pm.expect(item).to.have.property(\"image\").that.is.a(\"string\");\r",
									"  pm.expect(item).to.have.property(\"rating\").that.is.an(\"object\");\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-002 | GET /products | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"All items have numeric id and price\", () => {\r",
									"  const data = pm.response.json();\r",
									"  data.forEach(item => {\r",
									"    pm.expect(item.id).to.be.a(\"number\");\r",
									"    pm.expect(item.price).to.be.a(\"number\");\r",
									"  });\r",
									"});\r",
									"\r",
									"pm.test(\"Category field is consistently string\", () => {\r",
									"  const data = pm.response.json();\r",
									"  data.forEach(item => {\r",
									"    pm.expect(item.category).to.be.a(\"string\");\r",
									"  });\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/products",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-003 | GET /products | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is returned\", () => {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 400, 422]);\r",
									"});\r",
									"\r",
									"pm.test(\"Response is parsable\", () => {\r",
									"  pm.response.json();\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products?limit=abc",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							],
							"query": [
								{
									"key": "limit",
									"value": "abc"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-004 | POST /products | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 (Created)\", function () {\r",
									"  pm.expect(pm.response.code).to.equal(201);\r",
									"});\r",
									"\r",
									"let json = null;\r",
									"pm.test(\"Response is JSON\", function () {\r",
									"  json = pm.response.json();\r",
									"  pm.expect(json).to.be.an(\"object\");\r",
									"});\r",
									"\r",
									"pm.test(\"Response contains required product fields\", function () {\r",
									"  pm.expect(json).to.have.property(\"id\");\r",
									"  pm.expect(json).to.have.property(\"title\");\r",
									"  pm.expect(json).to.have.property(\"price\");\r",
									"  pm.expect(json).to.have.property(\"description\");\r",
									"  pm.expect(json).to.have.property(\"category\");\r",
									"  pm.expect(json).to.have.property(\"image\");\r",
									"});\r",
									"\r",
									"pm.test(\"Field types are correct\", function () {\r",
									"  pm.expect(json.id).to.satisfy(v => typeof v === \"number\" || typeof v === \"string\");\r",
									"  pm.expect(json.title).to.be.a(\"string\");\r",
									"  pm.expect(json.price).to.satisfy(v => typeof v === \"number\" || typeof v === \"string\");\r",
									"  pm.expect(json.category).to.be.a(\"string\");\r",
									"});\r",
									"\r",
									"// 留根：給後續 GET/PUT/DELETE 用\r",
									"if (json && json.id !== undefined) {\r",
									"  pm.environment.set(\"productId\", String(json.id));\r",
									"  pm.environment.set(\"productTitle\", json.title);\r",
									"  console.log(\"Saved env productId =\", pm.environment.get(\"productId\"));\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"title\": \"QA Postman Product - TC004\",\r\n  \"price\": 13.37,\r\n  \"description\": \"Contract test create product\",\r\n  \"image\": \"https://i.pravatar.cc/300\",\r\n  \"category\": \"electronics\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/products",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-005 | POST /products | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-005 Behavior: POST /products\r",
									"// Goal: validate behavior consistency & safe parsing, not persistence.\r",
									"\r",
									"pm.test(\"Status code is 200 or 201\", function () {\r",
									"  pm.expect([200, 201]).to.include(pm.response.code);\r",
									"});\r",
									"\r",
									"const raw = pm.response.text();\r",
									"pm.test(\"Response body is not empty\", function () {\r",
									"  pm.expect(raw && raw.trim().length > 0, \"Empty body\").to.be.true;\r",
									"});\r",
									"\r",
									"let json = null;\r",
									"pm.test(\"Response body is valid JSON\", function () {\r",
									"  pm.expect(() => { json = pm.response.json(); }, \"JSON parse failed\").to.not.throw();\r",
									"});\r",
									"\r",
									"pm.test(\"Behavior: required fields exist (id/title/price/category/image)\", function () {\r",
									"  pm.expect(json).to.be.an(\"object\");\r",
									"  [\"id\", \"title\", \"price\", \"category\", \"image\"].forEach((k) => {\r",
									"    pm.expect(json, `missing field: ${k}`).to.have.property(k);\r",
									"  });\r",
									"});\r",
									"\r",
									"// Type behavior checks (looser than contract; document real world)\r",
									"pm.test(\"Behavior: id is number or string\", function () {\r",
									"  pm.expect(json.id).to.satisfy(v => typeof v === \"number\" || typeof v === \"string\");\r",
									"});\r",
									"\r",
									"pm.test(\"Behavior: title is string\", function () {\r",
									"  pm.expect(json.title).to.be.a(\"string\");\r",
									"});\r",
									"\r",
									"pm.test(\"Behavior: price is number or string\", function () {\r",
									"  pm.expect(json.price).to.satisfy(v => typeof v === \"number\" || typeof v === \"string\");\r",
									"});\r",
									"\r",
									"pm.test(\"Behavior: category is string\", function () {\r",
									"  pm.expect(json.category).to.be.a(\"string\");\r",
									"});\r",
									"\r",
									"pm.test(\"Behavior: image is string (url-like allowed)\", function () {\r",
									"  pm.expect(json.image).to.be.a(\"string\");\r",
									"});\r",
									"\r",
									"// Save for downstream GET/PUT/DELETE (even if API is not persistent, keep the chain)\r",
									"if (json && json.id !== undefined) {\r",
									"  pm.environment.set(\"productId\", String(json.id));\r",
									"  pm.environment.set(\"productTitle\", json.title);\r",
									"  console.log(\"Saved env productId =\", pm.environment.get(\"productId\"));\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"title\": \"QA Postman Product - TC005\",\r\n  \"price\": 13.37,\r\n  \"description\": \"Contract test create product\",\r\n  \"image\": \"https://i.pravatar.cc/300\",\r\n  \"category\": \"electronics\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/products",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-006 | POST /products | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-006 ErrorHandling — POST /products\r",
									"// 07 定義：Verify missing or invalid body handling\r",
									"// 原則：不假設 API 會回 4xx，只記錄實際行為\r",
									"\r",
									"pm.test(\"[TC-006] Status code should be observable\", function () {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 201, 400, 422]);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"\r",
									"// Body may be empty or JSON — both acceptable for error handling observation\r",
									"let hasBody = trimmed.length > 0;\r",
									"let isJson = false;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-006] Response body handling is safe\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc006_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc006_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc006_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc006_bodyLength\", String(trimmed.length));\r",
									"\r",
									"// Behavior flag: API accepts invalid body if returns 200/201\r",
									"pm.environment.set(\r",
									"  \"tc006_invalidBodyAccepted\",\r",
									"  String(pm.response.code === 200 || pm.response.code === 201)\r",
									");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/products",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-007 | GET /products/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"let hasBody = pm.response.text().trim().length > 0;\r",
									"\r",
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Response is safe to consume\", function () {\r",
									"    if (hasBody) {\r",
									"        pm.expect(() => pm.response.json(), \"Body is not valid JSON\").to.not.throw();\r",
									"    } else {\r",
									"        pm.expect(hasBody, \"Body is empty but status is OK\").to.be.false;\r",
									"    }\r",
									"});\r",
									"\r",
									"pm.test(\"Product schema is valid if body exists\", function () {\r",
									"    if (hasBody) {\r",
									"        const json = pm.response.json();\r",
									"        pm.expect(json).to.have.property(\"id\");\r",
									"        pm.expect(json).to.have.property(\"title\");\r",
									"        pm.expect(json).to.have.property(\"price\");\r",
									"        pm.expect(json).to.have.property(\"category\");\r",
									"    } else {\r",
									"        pm.expect(true).to.be.true; // documented behavior\r",
									"    }\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/{{productId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{productId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-008 | GET /products/{id} | behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-008 Behavior: GET created/variant product\r",
									"pm.test(\"Status code is 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"// Capture raw body safely\r",
									"const raw = pm.response.text() || \"\";\r",
									"const hasBody = raw.trim().length > 0;\r",
									"\r",
									"pm.test(\"Response body is not empty (or document if empty)\", function () {\r",
									"  // For FakeStoreAPI, empty body can happen; we record it as behavior evidence.\r",
									"  // If you want strictness: change to pm.expect(hasBody).to.be.true;\r",
									"  pm.expect(true).to.be.true;\r",
									"});\r",
									"\r",
									"// Try parse JSON only when body exists\r",
									"let json = null;\r",
									"let parseOk = false;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    json = pm.response.json();\r",
									"    parseOk = true;\r",
									"  } catch (e) {\r",
									"    parseOk = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"Response is JSON if body exists\", function () {\r",
									"  if (hasBody) {\r",
									"    pm.expect(parseOk, \"JSON parse failed\").to.be.true;\r",
									"  } else {\r",
									"    pm.expect(true).to.be.true; // documented behavior\r",
									"  }\r",
									"});\r",
									"\r",
									"pm.test(\"Behavior fields are returned (if JSON exists)\", function () {\r",
									"  if (parseOk && json) {\r",
									"    pm.expect(json).to.have.property(\"id\");\r",
									"    pm.expect(json).to.have.property(\"title\");\r",
									"    pm.expect(json).to.have.property(\"price\");\r",
									"    pm.expect(json).to.have.property(\"description\");\r",
									"    pm.expect(json).to.have.property(\"category\");\r",
									"    pm.expect(json).to.have.property(\"image\");\r",
									"\r",
									"    // Behavior focus: we specifically check the variant fields we sent in TC-006\r",
									"    // category was 123 (number), image was \"not-a-url\" (string)\r",
									"    pm.expect(json.category, \"category should remain number or be coerced\").to.satisfy(v => typeof v === \"number\" || typeof v === \"string\");\r",
									"    pm.expect(json.image, \"image should be string\").to.be.a(\"string\");\r",
									"  } else {\r",
									"    pm.expect(true).to.be.true; // documented behavior\r",
									"  }\r",
									"});\r",
									"\r",
									"// Evidence logs for report\r",
									"console.log(\"TC-008 status:\", pm.response.code);\r",
									"console.log(\"TC-008 hasBody:\", hasBody);\r",
									"console.log(\"TC-008 raw length:\", raw.length);\r",
									"if (parseOk) console.log(\"TC-008 json:\", json);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/{{productId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{productId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-009 | GET /products/{invalidId} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-009 | GET /products/{invalidId} | ErrorHandling\r",
									"// Purpose: document how API behaves when productId is invalid/non-existing.\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const hasBody = raw && raw.trim().length > 0;\r",
									"\r",
									"// 1) Always assert we got a status code\r",
									"pm.test(\"Status code is returned\", function () {\r",
									"  pm.expect(status).to.be.a(\"number\");\r",
									"});\r",
									"\r",
									"// 2) Evidence logs (critical for report)\r",
									"console.log(\"TC-009 status:\", status);\r",
									"console.log(\"TC-009 invalidProductId:\", pm.environment.get(\"invalidProductId\"));\r",
									"console.log(\"TC-009 hasBody:\", hasBody);\r",
									"console.log(\"TC-009 rawLength:\", hasBody ? raw.length : 0);\r",
									"\r",
									"// 3) Try parse JSON if body exists\r",
									"let parsed = null;\r",
									"let parseOk = false;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    parsed = pm.response.json();\r",
									"    parseOk = true;\r",
									"  } catch (e) {\r",
									"    parseOk = false;\r",
									"    console.log(\"TC-009 JSON parse error:\", String(e));\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"Response body is either empty or parsable\", function () {\r",
									"  // Empty body is allowed as documented behavior; if not empty, must be parsable\r",
									"  pm.expect(!hasBody || parseOk).to.equal(true);\r",
									"});\r",
									"\r",
									"// 4) Classify behavior (do NOT force a single expected status)\r",
									"pm.test(\"Documented error-handling behavior is observed\", function () {\r",
									"  // Acceptable observations we want to classify, not judge:\r",
									"  // A) 404/400 with message (good typical error handling)\r",
									"  // B) 200 with empty body (seen in this API before)\r",
									"  // C) 200 with object/array (weird but document)\r",
									"  // D) 500 (server error - also document)\r",
									"\r",
									"  const isTypicalClientError = (status === 404 || status === 400 || status === 401 || status === 422);\r",
									"  const is200Empty = (status === 200 && !hasBody);\r",
									"  const is200Json = (status === 200 && hasBody && parseOk);\r",
									"  const isServerError = (status >= 500);\r",
									"\r",
									"  console.log(\"TC-009 classify:\",\r",
									"    JSON.stringify({\r",
									"      isTypicalClientError,\r",
									"      is200Empty,\r",
									"      is200Json,\r",
									"      isServerError\r",
									"    })\r",
									"  );\r",
									"\r",
									"  pm.expect(isTypicalClientError || is200Empty || is200Json || isServerError).to.equal(true);\r",
									"});\r",
									"\r",
									"// 5) Optional: if we got JSON, log a short summary without dumping huge data\r",
									"if (parseOk) {\r",
									"  const t = typeof parsed;\r",
									"  console.log(\"TC-009 parsedType:\", Array.isArray(parsed) ? \"array\" : t);\r",
									"  if (t === \"object\" && parsed) {\r",
									"    console.log(\"TC-009 parsedKeys:\", Object.keys(parsed).slice(0, 10));\r",
									"  }\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/{{invalidProductId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{invalidProductId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-010 | PUT /products/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-010 Contract — PUT /products/{id}\r",
									"// Validate response structure for update\r",
									"\r",
									"pm.test(\"[TC-010] Status code should be observable\", function () {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 201]);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"let tc010Data;\r",
									"pm.test(\"[TC-010] Response should be valid JSON object\", function () {\r",
									"  try {\r",
									"    tc010Data = pm.response.json();\r",
									"  } catch (e) {\r",
									"    pm.expect.fail(\"Response is not valid JSON\");\r",
									"  }\r",
									"  pm.expect(tc010Data).to.be.an(\"object\");\r",
									"});\r",
									"\r",
									"// Contract: basic product fields exist\r",
									"pm.test(\"[TC-010] Response should match product schema (basic fields)\", function () {\r",
									"  pm.expect(tc010Data).to.have.property(\"id\");\r",
									"  pm.expect(tc010Data).to.have.property(\"title\");\r",
									"  pm.expect(tc010Data).to.have.property(\"price\");\r",
									"  pm.expect(tc010Data).to.have.property(\"category\");\r",
									"  pm.expect(tc010Data).to.have.property(\"image\");\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc010_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc010_hasId\", String(tc010Data && tc010Data.id !== undefined));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"title\": \"QA Update Product TC-010\",\r\n  \"price\": 123.45,\r\n  \"description\": \"Update contract test\",\r\n  \"image\": \"https://i.pravatar.cc\",\r\n  \"category\": \"electronics\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/products/{{productId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{productId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-011 | PUT /products/{id} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-011 Behavior — PUT /products/{id}\r",
									"// Verify update behavior (do not assume response always reflects update)\r",
									"\r",
									"pm.test(\"[TC-011] Status code should be observable\", function () {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 201]);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"\r",
									"let tc011Data = null;\r",
									"let hasJson = false;\r",
									"\r",
									"if (trimmed.length > 0) {\r",
									"  try {\r",
									"    tc011Data = pm.response.json();\r",
									"    hasJson = true;\r",
									"  } catch (e) {\r",
									"    hasJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc011_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc011_hasJson\", String(hasJson));\r",
									"\r",
									"// Behavior flags (do NOT force fail)\r",
									"let titleUpdated = false;\r",
									"let priceUpdated = false;\r",
									"\r",
									"if (hasJson && tc011Data) {\r",
									"  if (tc011Data.title !== undefined) {\r",
									"    titleUpdated = (tc011Data.title === \"QA Update Product TC-011\");\r",
									"  }\r",
									"  if (tc011Data.price !== undefined) {\r",
									"    priceUpdated = (Number(tc011Data.price) === 999.99);\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.environment.set(\"tc011_titleUpdated\", String(titleUpdated));\r",
									"pm.environment.set(\"tc011_priceUpdated\", String(priceUpdated));\r",
									"\r",
									"pm.test(\"[TC-011] Update behavior observed (not enforced)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"title\": \"QA Update Product TC-011\",\r\n  \"price\": 999.99,\r\n  \"description\": \"Behavior update test\",\r\n  \"image\": \"https://i.pravatar.cc\",\r\n  \"category\": \"electronics\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/products/{{productId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{productId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-012 | PUT /products/{id} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-012 ErrorHandling — PUT /products/{id}\r",
									"// Verify invalid update handling\r",
									"\r",
									"pm.test(\"[TC-012] Status code should be observable\", function () {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 201, 400, 404, 422]);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"\r",
									"let isJson = false;\r",
									"if (trimmed.length > 0) {\r",
									"  try {\r",
									"    pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-012] Response safely handled\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc012_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc012_hasBody\", String(trimmed.length > 0));\r",
									"pm.environment.set(\"tc012_isJson\", String(isJson));\r",
									"\r",
									"// Behavior flag: invalid update accepted if 200/201\r",
									"pm.environment.set(\r",
									"  \"tc012_invalidUpdateAccepted\",\r",
									"  String(pm.response.code === 200 || pm.response.code === 201)\r",
									");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/products/{{invalidProductId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{invalidProductId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-013 | DELETE /products/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-013 Contract — DELETE /products/{id}\r",
									"// Goal: Validate delete \"response structure\" without assuming it must be JSON.\r",
									"// OpenAPI shows 200 with no explicit response body schema.\r",
									"\r",
									"pm.test(\"[TC-013] Status code should be 200 (contract)\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"// Safe-consumption guard: DELETE may return empty body or non-JSON.\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"pm.test(\"[TC-013] Response body is safely consumable (no crash)\", function () {\r",
									"  // Always pass if we can safely evaluate it; this test is about not blowing up.\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Contract-ish checks (lightweight, do not over-assert):\r",
									"// 1) If body exists and server claims JSON, it must be valid JSON.\r",
									"// 2) If body is empty, that's acceptable for DELETE.\r",
									"const ct = (pm.response.headers.get(\"Content-Type\") || \"\").toLowerCase();\r",
									"\r",
									"pm.test(\"[TC-013] Contract: empty body is acceptable for DELETE\", function () {\r",
									"  pm.expect(hasBody, \"hasBody\").to.be.oneOf([true, false]); // explicit, non-crashing\r",
									"  // Accept either empty or non-empty; nothing to assert beyond acceptability.\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-013] Contract: if Content-Type is JSON and has body, JSON must parse\", function () {\r",
									"  if (hasBody && ct.includes(\"application/json\")) {\r",
									"    let parsed;\r",
									"    try {\r",
									"      parsed = pm.response.json();\r",
									"    } catch (e) {\r",
									"      pm.expect.fail(\"Response claims JSON but cannot be parsed. raw=\" + trimmed.slice(0, 200));\r",
									"    }\r",
									"    // Don't over-assert fields; OpenAPI doesn't define delete body schema.\r",
									"    pm.expect(parsed).to.not.eql(undefined);\r",
									"  } else {\r",
									"    pm.expect(true).to.eql(true);\r",
									"  }\r",
									"});\r",
									"\r",
									"// Evidence/tracking vars (for Runner/Newman report traceability)\r",
									"pm.environment.set(\"tc013_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc013_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc013_bodyLength\", String((raw || \"\").length));\r",
									"\r",
									"// Optional: keep what we tried to delete (helps investigation later)\r",
									"pm.environment.set(\"deletedProductId\", String(pm.environment.get(\"productId\")));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/{{productId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{productId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-014 | DELETE /products/{id} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-014 Behavior — DELETE /products/{id}\r",
									"// 07 定義：Verify delete behavior\r",
									"// 原則：不替 API 找藉口；但也不讓 Tests 自己炸掉（safe-consume）\r",
									"\r",
									"pm.test(\"[TC-014] Status code should be 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"// safe-consumption guard\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"const ct = (pm.response.headers.get(\"Content-Type\") || \"\").toLowerCase();\r",
									"\r",
									"// Behavior: 記錄它到底回了什麼，而不是硬凹成「應該長怎樣」\r",
									"pm.test(\"[TC-014] Response is safely consumable (no crash)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// If it looks like JSON and has body, it must parse\r",
									"let parsed = null;\r",
									"if (hasBody && ct.includes(\"application/json\")) {\r",
									"  pm.test(\"[TC-014] If JSON body exists, it must be parseable\", function () {\r",
									"    try {\r",
									"      parsed = pm.response.json();\r",
									"    } catch (e) {\r",
									"      pm.expect.fail(\"Body claims JSON but cannot be parsed. raw=\" + trimmed.slice(0, 200));\r",
									"    }\r",
									"  });\r",
									"\r",
									"  // Optional behavior check: many APIs echo deleted object; if id is present, it should match.\r",
									"  pm.test(\"[TC-014] If body has id, it should match requested productId\", function () {\r",
									"    if (parsed && typeof parsed === \"object\" && Object.prototype.hasOwnProperty.call(parsed, \"id\")) {\r",
									"      pm.expect(String(parsed.id)).to.eql(String(pm.environment.get(\"productId\")));\r",
									"    } else {\r",
									"      // No id field => acceptable; just record via env for observation\r",
									"      pm.expect(true).to.eql(true);\r",
									"    }\r",
									"  });\r",
									"} else {\r",
									"  pm.test(\"[TC-014] Empty or non-JSON body is acceptable; record as observation\", function () {\r",
									"    pm.expect(true).to.eql(true);\r",
									"  });\r",
									"}\r",
									"\r",
									"// Evidence for Runner/Newman reports\r",
									"pm.environment.set(\"tc014_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc014_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc014_bodyLength\", String((raw || \"\").length));\r",
									"pm.environment.set(\"tc014_contentType\", ct);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/{{productId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{productId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-015 | DELETE /products/{id} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-015 ErrorHandling — DELETE /products/{id}\r",
									"// Goal: Observe how API behaves when deleting a non-existing product.\r",
									"// We do NOT assume ideal REST behavior.\r",
									"\r",
									"pm.test(\"[TC-015] Status code is observable (not crashing)\", function () {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 400, 404]);\r",
									"});\r",
									"\r",
									"// safe-consumption guard\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"const ct = (pm.response.headers.get(\"Content-Type\") || \"\").toLowerCase();\r",
									"\r",
									"pm.test(\"[TC-015] Response is safely consumable\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"if (hasBody && ct.includes(\"application/json\")) {\r",
									"  pm.test(\"[TC-015] If JSON body exists, it must be parseable\", function () {\r",
									"    try {\r",
									"      pm.response.json();\r",
									"    } catch (e) {\r",
									"      pm.expect.fail(\"Response claims JSON but cannot be parsed. raw=\" + trimmed.slice(0, 200));\r",
									"    }\r",
									"  });\r",
									"} else {\r",
									"  pm.test(\"[TC-015] Empty or non-JSON body is acceptable for error case\", function () {\r",
									"    pm.expect(true).to.eql(true);\r",
									"  });\r",
									"}\r",
									"\r",
									"// Evidence for report\r",
									"pm.environment.set(\"tc015_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc015_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc015_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc015_contentType\", ct);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/{{invalidProductId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"{{invalidProductId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-016 | GET /products/categories | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-016 Contract — GET /products/categories\r",
									"// Goal: Verify response is an array of strings per OpenAPI.\r",
									"\r",
									"pm.test(\"[TC-016] Status code should be 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"pm.test(\"[TC-016] Response body should not be empty\", function () {\r",
									"  pm.expect(trimmed.length).to.be.greaterThan(0);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-016] Response should be valid JSON array\", function () {\r",
									"  let data;\r",
									"  try {\r",
									"    data = pm.response.json();\r",
									"  } catch (e) {\r",
									"    pm.expect.fail(\"Response is not valid JSON. raw=\" + trimmed.slice(0, 200));\r",
									"  }\r",
									"  pm.expect(data).to.be.an(\"array\");\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-016] Array items should be strings\", function () {\r",
									"  const data = pm.response.json();\r",
									"  data.forEach((item, idx) => {\r",
									"    pm.expect(\r",
									"      typeof item,\r",
									"      `item[${idx}] should be string`\r",
									"    ).to.eql(\"string\");\r",
									"  });\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc016_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc016_count\", String(pm.response.json().length));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/categories",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"categories"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-017 | GET /products?limit={{limit}} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-017 Behavior — GET /products?limit={{limit}}\r",
									"// 07 定義：Verify number of returned items\r",
									"// 原則：驗「行為」：若 limit 被接受，回傳筆數應對應；若被忽略，必須記錄 Observation 的證據\r",
									"\r",
									"pm.test(\"[TC-017] Status code should be 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"pm.test(\"[TC-017] Response body should not be empty\", function () {\r",
									"  pm.expect(trimmed.length).to.be.greaterThan(0);\r",
									"});\r",
									"\r",
									"let tc017Data;\r",
									"pm.test(\"[TC-017] Response should be valid JSON array\", function () {\r",
									"  try {\r",
									"    tc017Data = pm.response.json();\r",
									"  } catch (e) {\r",
									"    pm.expect.fail(\"Response is not valid JSON. raw=\" + trimmed.slice(0, 200));\r",
									"  }\r",
									"  pm.expect(tc017Data).to.be.an(\"array\");\r",
									"});\r",
									"\r",
									"// Behavior focus: returned count vs requested limit\r",
									"const limitRaw = pm.environment.get(\"limit\");\r",
									"const limitNum = Number(limitRaw);\r",
									"const returnedCount = Array.isArray(tc017Data) ? tc017Data.length : -1;\r",
									"\r",
									"pm.test(\"[TC-017] Returned count should be observable\", function () {\r",
									"  pm.expect(returnedCount).to.be.at.least(0);\r",
									"});\r",
									"\r",
									"// We don't assume API MUST honor limit; we record whether it does.\r",
									"// If limit is a positive integer, acceptable behaviors:\r",
									"// - equals limit (honored)\r",
									"// - equals default full size (ignored) -> record observation\r",
									"pm.test(\"[TC-017] Behavior: limit honored or ignored (record evidence)\", function () {\r",
									"  // Require limit to be a finite number in this TC (valid limit case)\r",
									"  pm.expect(Number.isFinite(limitNum), \"limit should be numeric in this TC\").to.eql(true);\r",
									"  pm.expect(limitNum, \"limit should be > 0 in this TC\").to.be.greaterThan(0);\r",
									"\r",
									"  // Accept both: honored OR ignored. Do not fail just because it's ignored.\r",
									"  const honored = (returnedCount === limitNum);\r",
									"  pm.expect(honored).to.be.oneOf([true, false]);\r",
									"});\r",
									"\r",
									"// Evidence for Runner/Newman report & later observation write-up\r",
									"pm.environment.set(\"tc017_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc017_limit\", String(limitRaw));\r",
									"pm.environment.set(\"tc017_returnedCount\", String(returnedCount));\r",
									"pm.environment.set(\"tc017_limitHonored\", String(returnedCount === limitNum));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products?limit={{limit}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							],
							"query": [
								{
									"key": "limit",
									"value": "{{limit}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-018 | GET /products?limit={{invalidLimit}} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-018 ErrorHandling — GET /products?limit={{invalidLimit}}\r",
									"// Goal: Observe behavior when limit is invalid (non-numeric).\r",
									"// Do not assume ideal REST behavior; record evidence.\r",
									"\r",
									"pm.test(\"[TC-018] Status code should be observable (200 expected)\", function () {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 400, 422]);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"\r",
									"pm.test(\"[TC-018] Response body should not be empty\", function () {\r",
									"  pm.expect(trimmed.length).to.be.greaterThan(0);\r",
									"});\r",
									"\r",
									"let tc018Data;\r",
									"pm.test(\"[TC-018] Response should be valid JSON array\", function () {\r",
									"  try {\r",
									"    tc018Data = pm.response.json();\r",
									"  } catch (e) {\r",
									"    pm.expect.fail(\"Response is not valid JSON. raw=\" + trimmed.slice(0, 200));\r",
									"  }\r",
									"  pm.expect(tc018Data).to.be.an(\"array\");\r",
									"});\r",
									"\r",
									"// Evidence: record returned count and how API handled invalid input\r",
									"const returnedCount = Array.isArray(tc018Data) ? tc018Data.length : -1;\r",
									"\r",
									"pm.environment.set(\"tc018_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc018_invalidLimit\", String(pm.environment.get(\"invalidLimit\")));\r",
									"pm.environment.set(\"tc018_returnedCount\", String(returnedCount));\r",
									"\r",
									"// Behavior flag: invalid limit ignored if returns default full size (usually 20)\r",
									"pm.environment.set(\r",
									"  \"tc018_invalidLimitIgnored\",\r",
									"  String(returnedCount > 0 && returnedCount !== 0)\r",
									");\r",
									"\r",
									"pm.test(\"[TC-018] Invalid limit behavior recorded\", function () {\r",
									"  pm.expect(returnedCount).to.be.at.least(0);\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products?limit={{invalidLimit}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							],
							"query": [
								{
									"key": "limit",
									"value": "{{invalidLimit}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-019 | GET /products?limit=0 | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-019 ErrorHandling — GET /products?limit=0\r",
									"// Goal: Observe how API handles numeric edge value 0.\r",
									"\r",
									"pm.test(\"[TC-019] Status code should be observable\", function () {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 400, 422]);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"\r",
									"pm.test(\"[TC-019] Response body should not be empty\", function () {\r",
									"  pm.expect(trimmed.length).to.be.greaterThan(0);\r",
									"});\r",
									"\r",
									"let tc019Data;\r",
									"pm.test(\"[TC-019] Response should be valid JSON array\", function () {\r",
									"  try {\r",
									"    tc019Data = pm.response.json();\r",
									"  } catch (e) {\r",
									"    pm.expect.fail(\"Response is not valid JSON. raw=\" + trimmed.slice(0, 200));\r",
									"  }\r",
									"  pm.expect(tc019Data).to.be.an(\"array\");\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"const returnedCount = Array.isArray(tc019Data) ? tc019Data.length : -1;\r",
									"\r",
									"pm.environment.set(\"tc019_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc019_returnedCount\", String(returnedCount));\r",
									"\r",
									"// Behavior flag: limit=0 ignored if returnedCount > 0\r",
									"pm.environment.set(\r",
									"  \"tc019_limitZeroIgnored\",\r",
									"  String(returnedCount > 0)\r",
									");\r",
									"\r",
									"pm.test(\"[TC-019] limit=0 behavior recorded\", function () {\r",
									"  pm.expect(returnedCount).to.be.at.least(0);\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products?sort={{sort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{sort}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-020 | GET /products?sort={{sort}} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-020 Behavior — GET /products?sort={{sort}}\r",
									"// 07 定義：Verify sorting order\r",
									"// 原則：只驗排序方向是否符合請求，不做 schema 驗證\r",
									"\r",
									"pm.test(\"[TC-020] Status code should be 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"let tc020Data;\r",
									"pm.test(\"[TC-020] Response should be valid JSON array\", function () {\r",
									"  try {\r",
									"    tc020Data = pm.response.json();\r",
									"  } catch (e) {\r",
									"    pm.expect.fail(\"Invalid JSON response\");\r",
									"  }\r",
									"  pm.expect(tc020Data).to.be.an(\"array\");\r",
									"});\r",
									"\r",
									"// Behavior: verify sorting order by id\r",
									"const sort = pm.environment.get(\"sort\");\r",
									"const ids = tc020Data.map(item => item.id);\r",
									"\r",
									"// helper\r",
									"function isSortedAsc(arr) {\r",
									"  for (let i = 1; i < arr.length; i++) {\r",
									"    if (arr[i] < arr[i - 1]) return false;\r",
									"  }\r",
									"  return true;\r",
									"}\r",
									"function isSortedDesc(arr) {\r",
									"  for (let i = 1; i < arr.length; i++) {\r",
									"    if (arr[i] > arr[i - 1]) return false;\r",
									"  }\r",
									"  return true;\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-020] Sorting order should match sort parameter\", function () {\r",
									"  if (sort === \"asc\") {\r",
									"    pm.expect(isSortedAsc(ids)).to.eql(true);\r",
									"  } else if (sort === \"desc\") {\r",
									"    pm.expect(isSortedDesc(ids)).to.eql(true);\r",
									"  } else {\r",
									"    pm.expect.fail(\"Invalid sort value used in TC-020\");\r",
									"  }\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc020_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc020_sort\", String(sort));\r",
									"pm.environment.set(\"tc020_orderValid\", String(\r",
									"  sort === \"asc\" ? isSortedAsc(ids) :\r",
									"  sort === \"desc\" ? isSortedDesc(ids) : false\r",
									"));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products?sort={{sort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{sort}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-021 | GET /products?sort={{invalidSort}} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-021 ErrorHandling — GET /products?sort={{invalidSort}}\r",
									"// 07 定義：Verify invalid sort value handling\r",
									"// 原則：不假設 API 會報錯，只記錄實際行為\r",
									"\r",
									"pm.test(\"[TC-021] Status code should be observable\", function () {\r",
									"  pm.expect(pm.response.code).to.be.oneOf([200, 400, 422]);\r",
									"});\r",
									"\r",
									"// safe-consume\r",
									"let tc021Data;\r",
									"pm.test(\"[TC-021] Response should be valid JSON array\", function () {\r",
									"  try {\r",
									"    tc021Data = pm.response.json();\r",
									"  } catch (e) {\r",
									"    pm.expect.fail(\"Invalid JSON response\");\r",
									"  }\r",
									"  pm.expect(tc021Data).to.be.an(\"array\");\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc021_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc021_invalidSort\", String(pm.environment.get(\"invalidSort\")));\r",
									"pm.environment.set(\"tc021_returnedCount\", String(tc021Data.length));\r",
									"\r",
									"// Behavior flag: invalid sort ignored if still returns full list\r",
									"pm.environment.set(\r",
									"  \"tc021_invalidSortIgnored\",\r",
									"  String(tc021Data.length > 0)\r",
									");\r",
									"\r",
									"pm.test(\"[TC-021] Invalid sort behavior recorded\", function () {\r",
									"  pm.expect(tc021Data.length).to.be.at.least(0);\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products?sort={{invalidSort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{invalidSort}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-022 | GET /products/categories | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-022 | Contract: category list schema\r",
									"\r",
									"pm.test(\"TC-022 status is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"let tc022Data;\r",
									"pm.test(\"TC-022 response is valid JSON array\", function () {\r",
									"    tc022Data = pm.response.json();\r",
									"    pm.expect(Array.isArray(tc022Data)).to.eq(true);\r",
									"});\r",
									"\r",
									"pm.test(\"TC-022 all items are strings\", function () {\r",
									"    tc022Data.forEach((item, idx) => {\r",
									"        pm.expect(\r",
									"            typeof item,\r",
									"            `Item at index ${idx} should be string`\r",
									"        ).to.eq(\"string\");\r",
									"    });\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc022_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc022_isArray\", String(Array.isArray(tc022Data)));\r",
									"pm.environment.set(\"tc022_count\", String(tc022Data.length));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/categories",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"categories"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-023 | GET /products/categories | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-023 | Behavior: category list content\r",
									"\r",
									"const tc023Data = pm.response.json();\r",
									"\r",
									"pm.test(\"TC-023 status is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"TC-023 category list is not empty\", function () {\r",
									"    pm.expect(tc023Data.length).to.be.greaterThan(0);\r",
									"});\r",
									"\r",
									"pm.test(\"TC-023 no empty string in categories\", function () {\r",
									"    tc023Data.forEach((item, idx) => {\r",
									"        pm.expect(\r",
									"            item.trim().length,\r",
									"            `Category at index ${idx} should not be empty`\r",
									"        ).to.be.greaterThan(0);\r",
									"    });\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc023_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc023_count\", String(tc023Data.length));\r",
									"pm.environment.set(\"tc023_hasEmptyValue\", String(\r",
									"    tc023Data.some(v => typeof v === \"string\" && v.trim() === \"\")\r",
									"));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/categories",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"categories"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-024 | GET /products/categories | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-024 | ErrorHandling: unexpected error behavior\r",
									"\r",
									"let status = pm.response.code;\r",
									"let isJson = true;\r",
									"\r",
									"try {\r",
									"    pm.response.json();\r",
									"} catch (e) {\r",
									"    isJson = false;\r",
									"}\r",
									"\r",
									"pm.test(\"TC-024 API responds without server error\", function () {\r",
									"    pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// Evidence only (do NOT fail test)\r",
									"pm.environment.set(\"tc024_status\", String(status));\r",
									"pm.environment.set(\"tc024_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc024_behaviorObserved\", \"no_error_path_exposed\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/products/categories",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"categories"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-025 | GET /products/category/{category} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const status = pm.response.code;\r",
									"pm.expect(status).to.equal(200);\r",
									"\r",
									"const tc025Data = pm.response.json();\r",
									"\r",
									"// Contract: must be array\r",
									"pm.expect(Array.isArray(tc025Data)).to.equal(true);\r",
									"\r",
									"// Contract: each item schema\r",
									"tc025Data.forEach((item, idx) => {\r",
									"  pm.expect(item).to.have.property(\"id\");\r",
									"  pm.expect(item).to.have.property(\"title\");\r",
									"  pm.expect(item).to.have.property(\"price\");\r",
									"  pm.expect(item).to.have.property(\"description\");\r",
									"  pm.expect(item).to.have.property(\"category\");\r",
									"  pm.expect(item).to.have.property(\"image\");\r",
									"  pm.expect(item).to.have.property(\"rating\");\r",
									"\r",
									"  pm.expect(item.rating).to.have.property(\"rate\");\r",
									"  pm.expect(item.rating).to.have.property(\"count\");\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc025_status\", String(status));\r",
									"pm.environment.set(\"tc025_isArray\", String(Array.isArray(tc025Data)));\r",
									"pm.environment.set(\"tc025_count\", String(tc025Data.length));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/products/category/{{category}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"category",
								"{{category}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-026 | GET /products/category/{category} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const tc026Data = pm.response.json();\r",
									"const expectedCategory = pm.environment.get(\"category\");\r",
									"\r",
									"// Behavior: all items belong to the category\r",
									"let allMatch = true;\r",
									"\r",
									"tc026Data.forEach(item => {\r",
									"  if (item.category !== expectedCategory) {\r",
									"    allMatch = false;\r",
									"  }\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-026] All products filtered by category\", function () {\r",
									"  pm.expect(allMatch).to.equal(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc026_status\", String(pm.response.code));\r",
									"pm.environment.set(\"tc026_category\", expectedCategory);\r",
									"pm.environment.set(\"tc026_allMatch\", String(allMatch));\r",
									"pm.environment.set(\"tc026_count\", String(tc026Data.length));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/products/category/{{category}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"category",
								"{{category}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-027 | GET /products/category/{category} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const status = pm.response.code;\r",
									"let tc027Data;\r",
									"let isArray = false;\r",
									"\r",
									"try {\r",
									"  tc027Data = pm.response.json();\r",
									"  isArray = Array.isArray(tc027Data);\r",
									"} catch (e) {\r",
									"  tc027Data = null;\r",
									"}\r",
									"\r",
									"// ErrorHandling: API may return 200 + empty array OR 4xx\r",
									"pm.test(\"[TC-027] Invalid category handling recorded\", function () {\r",
									"  pm.expect([200, 400, 404]).to.include(status);\r",
									"});\r",
									"\r",
									"// Evidence only\r",
									"pm.environment.set(\"tc027_status\", String(status));\r",
									"pm.environment.set(\"tc027_isArray\", String(isArray));\r",
									"pm.environment.set(\r",
									"  \"tc027_emptyResult\",\r",
									"  String(isArray && tc027Data.length === 0)\r",
									");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/products/category/{{invalidCategory}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"products",
								"category",
								"{{invalidCategory}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "02_Carts",
			"item": [
				{
					"name": "TC-028 | GET /carts | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ---------- TC-028 | Contract | GET /carts ----------\r",
									"\r",
									"// Basic response info\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const trimmed = text ? text.trim() : \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"// Safe JSON parse\r",
									"let tc028Data = null;\r",
									"let isJson = false;\r",
									"let isArray = false;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc028Data = pm.response.json();\r",
									"    isJson = true;\r",
									"    isArray = Array.isArray(tc028Data);\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"// ---------- Assertions (Contract) ----------\r",
									"\r",
									"// Status code\r",
									"pm.test(\"[TC-028] Status code should be 200\", function () {\r",
									"  pm.expect(status).to.equal(200);\r",
									"});\r",
									"\r",
									"// Response must be JSON array\r",
									"pm.test(\"[TC-028] Response should be a JSON array\", function () {\r",
									"  pm.expect(isJson).to.equal(true);\r",
									"  pm.expect(isArray).to.equal(true);\r",
									"});\r",
									"\r",
									"// Validate cart item schema (structure only)\r",
									"pm.test(\"[TC-028] Cart item schema is valid\", function () {\r",
									"  if (!isArray || tc028Data.length === 0) {\r",
									"    // Empty array is acceptable for contract\r",
									"    pm.expect(true).to.equal(true);\r",
									"    return;\r",
									"  }\r",
									"\r",
									"  const item = tc028Data[0];\r",
									"\r",
									"  pm.expect(item).to.have.property(\"id\");\r",
									"  pm.expect(item).to.have.property(\"userId\");\r",
									"  pm.expect(item).to.have.property(\"date\");\r",
									"  pm.expect(item).to.have.property(\"products\");\r",
									"\r",
									"  pm.expect(item.products).to.be.an(\"array\");\r",
									"\r",
									"  if (item.products.length > 0) {\r",
									"    const p = item.products[0];\r",
									"    pm.expect(p).to.have.property(\"productId\");\r",
									"    pm.expect(p).to.have.property(\"quantity\");\r",
									"  }\r",
									"});\r",
									"\r",
									"// ---------- Evidence for report ----------\r",
									"pm.environment.set(\"tc028_status\", String(status));\r",
									"pm.environment.set(\"tc028_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc028_isArray\", String(isArray));\r",
									"pm.environment.set(\r",
									"  \"tc028_count\",\r",
									"  String(isArray ? tc028Data.length : 0)\r",
									");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-029 | GET /carts | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ---------- TC-029 | Behavior | GET /carts ----------\r",
									"\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const trimmed = text ? text.trim() : \"\";\r",
									"\r",
									"let tc029Data = [];\r",
									"let isArray = false;\r",
									"\r",
									"if (trimmed.length > 0) {\r",
									"  try {\r",
									"    tc029Data = pm.response.json();\r",
									"    isArray = Array.isArray(tc029Data);\r",
									"  } catch (e) {\r",
									"    isArray = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"// ---- Behavior assertions ----\r",
									"\r",
									"// API should respond normally\r",
									"pm.test(\"[TC-029] Status code should be 200\", function () {\r",
									"  pm.expect(status).to.equal(200);\r",
									"});\r",
									"\r",
									"// carts list should be an array\r",
									"pm.test(\"[TC-029] Response should be an array\", function () {\r",
									"  pm.expect(isArray).to.equal(true);\r",
									"});\r",
									"\r",
									"// carts should be readable (length >= 0)\r",
									"pm.test(\"[TC-029] Cart list should be readable\", function () {\r",
									"  pm.expect(tc029Data.length).to.be.at.least(0);\r",
									"});\r",
									"\r",
									"// ---- Evidence for report ----\r",
									"pm.environment.set(\"tc029_status\", String(status));\r",
									"pm.environment.set(\"tc029_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc029_count\", String(isArray ? tc029Data.length : 0));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-030 | GET /carts | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ---------- TC-030 | ErrorHandling | GET /carts ----------\r",
									"\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const trimmed = text ? text.trim() : \"\";\r",
									"\r",
									"let isJson = false;\r",
									"\r",
									"if (trimmed.length > 0) {\r",
									"  try {\r",
									"    pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"// ---- Error handling assertions ----\r",
									"\r",
									"// Should NOT return server error\r",
									"pm.test(\"[TC-030] API should not return 5xx error\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// ---- Evidence only (observation-based) ----\r",
									"pm.environment.set(\"tc030_status\", String(status));\r",
									"pm.environment.set(\"tc030_isJson\", String(isJson));\r",
									"pm.environment.set(\r",
									"  \"tc030_behaviorObserved\",\r",
									"  \"no_error_path_exposed\"\r",
									");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-031 | POST /carts | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ---------- TC-031 | Contract | POST /carts ----------\r",
									"\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const trimmed = text ? text.trim() : \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc031Data = null;\r",
									"let isJson = false;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc031Data = pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"// Status: commonly 200/201 (record actual but enforce one of them)\r",
									"pm.test(\"[TC-031] Status should be 200 or 201\", function () {\r",
									"  pm.expect([200, 201]).to.include(status);\r",
									"});\r",
									"\r",
									"// Contract: response must be JSON object with at least id\r",
									"pm.test(\"[TC-031] Response should be JSON object with id\", function () {\r",
									"  pm.expect(isJson).to.equal(true);\r",
									"  pm.expect(tc031Data).to.be.an(\"object\");\r",
									"  pm.expect(tc031Data).to.have.property(\"id\");\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc031_status\", String(status));\r",
									"pm.environment.set(\"tc031_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc031_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc031_hasId\", String(isJson && tc031Data && tc031Data.id !== undefined));\r",
									"\r",
									"// Store created cart id for later use\r",
									"if (isJson && tc031Data && tc031Data.id !== undefined) {\r",
									"  pm.environment.set(\"cartId\", String(tc031Data.id));\r",
									"  pm.environment.set(\"tc031_cartId\", String(tc031Data.id));\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.test(\"[GUARD] Method must be POST\", function () {\r",
									"  pm.expect(pm.request.method).to.equal(\"POST\");\r",
									"});\r",
									"\r",
									"pm.test(\"[GUARD] URL must include /carts\", function () {\r",
									"  pm.expect(pm.request.url.toString()).to.include(\"/carts\");\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userId\": 1,\r\n  \"date\": \"2020-03-02\",\r\n  \"products\": [\r\n    { \"productId\": 1, \"quantity\": 1 },\r\n    { \"productId\": 2, \"quantity\": 2 }\r\n  ]\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/carts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-032 | POST /carts | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ---------- TC-032 | Behavior | POST /carts ----------\r",
									"\r",
									"const status = pm.response.code;\r",
									"const reqBody = pm.request.body && pm.request.body.raw ? pm.request.body.raw : \"\";\r",
									"let req = null;\r",
									"\r",
									"try { req = JSON.parse(reqBody); } catch (e) { req = null; }\r",
									"\r",
									"// Parse response safely\r",
									"const text = pm.response.text();\r",
									"const trimmed = text ? text.trim() : \"\";\r",
									"let res = null;\r",
									"let isJson = false;\r",
									"\r",
									"if (trimmed.length > 0) {\r",
									"  try { res = pm.response.json(); isJson = true; } catch (e) { isJson = false; }\r",
									"}\r",
									"\r",
									"// Behavior: creation should return an id (recorded), but API may not echo full body\r",
									"let hasId = isJson && res && res.id !== undefined;\r",
									"\r",
									"pm.test(\"[TC-032] Status should be 200 or 201\", function () {\r",
									"  pm.expect([200, 201]).to.include(status);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-032] Created cart id should exist (behavior)\", function () {\r",
									"  pm.expect(hasId).to.equal(true);\r",
									"});\r",
									"\r",
									"// Optional: if API echoes userId, it should match request (do not fail if not present)\r",
									"let userIdMatches = null;\r",
									"if (isJson && res && res.userId !== undefined && req && req.userId !== undefined) {\r",
									"  userIdMatches = (String(res.userId) === String(req.userId));\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-032] If response includes userId, it should match request (non-strict)\", function () {\r",
									"  pm.expect(userIdMatches === null || userIdMatches === true).to.equal(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc032_status\", String(status));\r",
									"pm.environment.set(\"tc032_hasId\", String(hasId));\r",
									"pm.environment.set(\"tc032_userIdEchoed\", String(isJson && res && res.userId !== undefined));\r",
									"pm.environment.set(\"tc032_userIdMatches\", String(userIdMatches === null ? \"N/A\" : userIdMatches));\r",
									"\r",
									"if (hasId) {\r",
									"  pm.environment.set(\"cartId\", String(res.id));\r",
									"  pm.environment.set(\"tc032_cartId\", String(res.id));\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userId\": 1,\r\n  \"date\": \"2020-03-02\",\r\n  \"products\": [\r\n    { \"productId\": 1, \"quantity\": 1 },\r\n    { \"productId\": 2, \"quantity\": 2 }\r\n  ]\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/carts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-033 | POST /carts | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ---------- TC-033 | ErrorHandling | POST /carts ----------\r",
									"\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const trimmed = text ? text.trim() : \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"if (hasBody) {\r",
									"  try { pm.response.json(); isJson = true; } catch (e) { isJson = false; }\r",
									"}\r",
									"\r",
									"// Error handling: API may reject with 4xx OR (badly) accept and return 200/201.\r",
									"// We record which happens. Do not assume perfect validation.\r",
									"pm.test(\"[TC-033] Invalid body handling recorded (no 5xx)\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc033_status\", String(status));\r",
									"pm.environment.set(\"tc033_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc033_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc033_invalidBodyAccepted\", String([200, 201].includes(status)));\r",
									"pm.environment.set(\"tc033_behaviorObserved\", String([200, 201].includes(status) ? \"accepted_invalid_body\" : \"rejected_invalid_body\"));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userId\": \"one\",\r\n  \"date\": \"not-a-date\",\r\n  \"products\": \"nope\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/carts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-034 | GET /carts/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-034 | GET /carts/{id} | Contract\r",
									"\r",
									"const status = pm.response.code;\r",
									"const expectedIdRaw = pm.environment.get(\"cartId\");\r",
									"\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc034Data;\r",
									"let isJsonObject = false;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc034Data = pm.response.json();\r",
									"    // treat JSON null as NOT usable object\r",
									"    isJsonObject = (tc034Data !== null && typeof tc034Data === \"object\" && !Array.isArray(tc034Data));\r",
									"  } catch (e) {\r",
									"    isJsonObject = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"// ---- Tests ----\r",
									"pm.test(\"[TC-034] Status should be 200\", function () {\r",
									"  pm.expect(status).to.equal(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-034] Response should be JSON object (or record anomaly)\", function () {\r",
									"  // Always pass to avoid runner break; evidence will tell the truth.\r",
									"  pm.expect(true).to.equal(true);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-034] Contract: should include id, userId, date, products (guarded)\", function () {\r",
									"  if (!hasBody || !isJsonObject) {\r",
									"    pm.expect(true).to.equal(true);\r",
									"    return;\r",
									"  }\r",
									"  pm.expect(tc034Data).to.have.property(\"id\");\r",
									"  pm.expect(tc034Data).to.have.property(\"userId\");\r",
									"  pm.expect(tc034Data).to.have.property(\"date\");\r",
									"  pm.expect(tc034Data).to.have.property(\"products\");\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-034] Contract: products items should include productId & quantity (guarded)\", function () {\r",
									"  if (!hasBody || !isJsonObject) {\r",
									"    pm.expect(true).to.equal(true);\r",
									"    return;\r",
									"  }\r",
									"\r",
									"  pm.expect(Array.isArray(tc034Data.products)).to.equal(true);\r",
									"\r",
									"  // Only validate item shape when products is an array\r",
									"  tc034Data.products.forEach((p, idx) => {\r",
									"    pm.expect(p, `products[${idx}] should be object`).to.be.an(\"object\");\r",
									"    pm.expect(p, `products[${idx}] should have productId`).to.have.property(\"productId\");\r",
									"    pm.expect(p, `products[${idx}] should have quantity`).to.have.property(\"quantity\");\r",
									"  });\r",
									"});\r",
									"\r",
									"// ---- Evidence (Newman/Runner-friendly) ----\r",
									"pm.environment.set(\"tc034_status\", String(status));\r",
									"pm.environment.set(\"tc034_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc034_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc034_isJsonObject\", String(isJsonObject));\r",
									"pm.environment.set(\"tc034_expectedCartId\", String(expectedIdRaw));\r",
									"\r",
									"let observed =\r",
									"  status === 200 && !hasBody ? \"200_empty_body\" :\r",
									"  status === 200 && hasBody && !isJsonObject ? \"200_json_null_or_nonobject\" :\r",
									"  status === 200 && hasBody && isJsonObject ? \"200_json_object\" :\r",
									"  \"other_\" + status;\r",
									"\r",
									"pm.environment.set(\"tc034_behaviorObserved\", observed);\r",
									"\r",
									"// Contract key check (only meaningful when usable object)\r",
									"if (hasBody && isJsonObject) {\r",
									"  const hasKeys =\r",
									"    tc034Data && [\"id\", \"userId\", \"date\", \"products\"].every(k => Object.prototype.hasOwnProperty.call(tc034Data, k));\r",
									"  pm.environment.set(\"tc034_hasContractKeys\", String(hasKeys));\r",
									"\r",
									"  // Optional: id match evidence (do not fail contract on mismatch here, just record)\r",
									"  pm.environment.set(\"tc034_idMatches\", String(String(tc034Data.id) === String(expectedIdRaw)));\r",
									"\r",
									"  // products count evidence\r",
									"  pm.environment.set(\"tc034_productsCount\", String(Array.isArray(tc034Data.products) ? tc034Data.products.length : 0));\r",
									"} else {\r",
									"  pm.environment.set(\"tc034_hasContractKeys\", \"N/A\");\r",
									"  pm.environment.set(\"tc034_idMatches\", \"N/A\");\r",
									"  pm.environment.set(\"tc034_productsCount\", \"N/A\");\r",
									"}\r",
									"\r",
									"pm.environment.set(\"tc034_rawHead\", trimmed.slice(0, 120));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts/{{cartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{cartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-035 | GET /carts/{id} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-035 | GET /carts/{id} | Behavior\r",
									"\r",
									"const status = pm.response.code;\r",
									"const expectedIdRaw = pm.environment.get(\"cartId\");\r",
									"\r",
									"// Raw evidence\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc035Data;\r",
									"let isJson = false;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc035Data = pm.response.json();\r",
									"    // IMPORTANT: treat JSON 'null' as NOT usable object\r",
									"    isJson = (tc035Data !== null);\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"// --- Tests ---\r",
									"pm.test(\"[TC-035] Status should be 200\", function () {\r",
									"  pm.expect(status).to.equal(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-035] Response should be JSON object (or record anomaly)\", function () {\r",
									"  // If empty body OR JSON null OR non-JSON -> do not crash; record anomaly\r",
									"  pm.expect(true).to.equal(true);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-035] Returned id should match requested cartId (guarded)\", function () {\r",
									"  if (!hasBody || !isJson || typeof tc035Data !== \"object\") {\r",
									"    pm.expect(true).to.equal(true);\r",
									"    return;\r",
									"  }\r",
									"  pm.expect(String(tc035Data.id)).to.equal(String(expectedIdRaw));\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-035] Products should be an array (guarded)\", function () {\r",
									"  if (!hasBody || !isJson || typeof tc035Data !== \"object\") {\r",
									"    pm.expect(true).to.equal(true);\r",
									"    return;\r",
									"  }\r",
									"  pm.expect(Array.isArray(tc035Data.products)).to.equal(true);\r",
									"});\r",
									"\r",
									"// --- Evidence (Newman/Runner-friendly) ---\r",
									"pm.environment.set(\"tc035_status\", String(status));\r",
									"pm.environment.set(\"tc035_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc035_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc035_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc035_expectedCartId\", String(expectedIdRaw));\r",
									"\r",
									"const observed =\r",
									"  status === 200 && !hasBody ? \"200_empty_body\" :\r",
									"  status === 200 && hasBody && !isJson ? \"200_json_null_or_nonobject\" :\r",
									"  status === 200 && hasBody && isJson ? \"200_json_body\" :\r",
									"  \"other_\" + status;\r",
									"\r",
									"pm.environment.set(\"tc035_behaviorObserved\", observed);\r",
									"\r",
									"// Only set these when safe (avoid writing \"null\" confusion)\r",
									"if (hasBody && isJson && typeof tc035Data === \"object\") {\r",
									"  pm.environment.set(\"tc035_idMatches\", String(String(tc035Data.id) === String(expectedIdRaw)));\r",
									"  pm.environment.set(\"tc035_productsCount\", String(Array.isArray(tc035Data.products) ? tc035Data.products.length : 0));\r",
									"} else {\r",
									"  pm.environment.set(\"tc035_idMatches\", \"N/A\");\r",
									"  pm.environment.set(\"tc035_productsCount\", \"N/A\");\r",
									"}\r",
									"\r",
									"// small raw head for evidence (avoid huge)\r",
									"pm.environment.set(\"tc035_rawHead\", trimmed.slice(0, 120));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts/{{cartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{cartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-036 | GET /carts/{id} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ---------- TC-036 | ErrorHandling | GET /carts/{id} invalid ----------\r",
									"\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const trimmed = text ? text.trim() : \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"// We only record; FakeStore may return 200 with empty/non-empty behavior.\r",
									"let isJson = false;\r",
									"if (hasBody) {\r",
									"  try { pm.response.json(); isJson = true; } catch (e) { isJson = false; }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-036] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc036_status\", String(status));\r",
									"pm.environment.set(\"tc036_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc036_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc036_behaviorObserved\", String(\r",
									"  status === 404 ? \"not_found\" :\r",
									"  status === 200 ? \"unexpected_200\" :\r",
									"  \"other_\" + status\r",
									"));\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts/{{invalidCartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{invalidCartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-037 | PUT /carts/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-037 | PUT /carts/{id} | Contract\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text() || \"\";\r",
									"const trimmed = raw.trim();\r",
									"\r",
									"let isJson = false;\r",
									"let tc037Data = null;\r",
									"try {\r",
									"  tc037Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {}\r",
									"\r",
									"const hasBody = trimmed.length > 0;\r",
									"const isObject = isJson && tc037Data !== null && typeof tc037Data === \"object\" && !Array.isArray(tc037Data);\r",
									"\r",
									"pm.test(\"[TC-037] Status should be 200 or 201 (record evidence if different)\", function () {\r",
									"  pm.expect([200, 201]).to.include(status);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-037] Response should be JSON object (or record anomaly)\", function () {\r",
									"  pm.expect(true).to.eq(true); // do not hard-fail on provider anomaly\r",
									"});\r",
									"\r",
									"// Contract guarded checks\r",
									"if (isObject) {\r",
									"  pm.test(\"[TC-037] Contract: should include id, userId, date, products\", function () {\r",
									"    [\"id\", \"userId\", \"date\", \"products\"].forEach((k) => pm.expect(tc037Data).to.have.property(k));\r",
									"  });\r",
									"\r",
									"  pm.test(\"[TC-037] Contract: products items should include productId & quantity\", function () {\r",
									"    pm.expect(Array.isArray(tc037Data.products)).to.eq(true);\r",
									"    tc037Data.products.forEach((p) => {\r",
									"      pm.expect(p).to.have.property(\"productId\");\r",
									"      pm.expect(p).to.have.property(\"quantity\");\r",
									"    });\r",
									"  });\r",
									"}\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc037_status\", String(status));\r",
									"pm.environment.set(\"tc037_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc037_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc037_isJsonObject\", String(isObject));\r",
									"pm.environment.set(\"tc037_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc037_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userId\": 1,\r\n  \"date\": \"2020-03-02T00:00:00.000Z\",\r\n  \"products\": [\r\n    { \"productId\": 1, \"quantity\": 2 },\r\n    { \"productId\": 2, \"quantity\": 1 }\r\n  ]\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/carts/{{cartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{cartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-038 | PUT /carts/{id} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-038 | PUT /carts/{id} | Behavior\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text() || \"\";\r",
									"const trimmed = raw.trim();\r",
									"\r",
									"let isJson = false;\r",
									"let tc038Data = null;\r",
									"try {\r",
									"  tc038Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {}\r",
									"\r",
									"const hasBody = trimmed.length > 0;\r",
									"const isObject = isJson && tc038Data !== null && typeof tc038Data === \"object\" && !Array.isArray(tc038Data);\r",
									"\r",
									"// expected from request (must match what you actually set in Body)\r",
									"const expectedUserId = 2;\r",
									"const expectedFirstProductId = 1;\r",
									"const expectedFirstQty = 9;\r",
									"\r",
									"pm.test(\"[TC-038] Status should be 200 or 201 (record evidence)\", function () {\r",
									"  pm.expect([200, 201]).to.include(status);\r",
									"});\r",
									"\r",
									"// Guarded behavior observation\r",
									"let userIdEchoed = \"N/A\";\r",
									"let firstLineMatched = \"N/A\";\r",
									"\r",
									"if (isObject) {\r",
									"  userIdEchoed = String(tc038Data.userId === expectedUserId);\r",
									"  if (Array.isArray(tc038Data.products) && tc038Data.products.length > 0) {\r",
									"    const p0 = tc038Data.products[0];\r",
									"    firstLineMatched = String(\r",
									"      String(p0.productId) === String(expectedFirstProductId) &&\r",
									"      String(p0.quantity) === String(expectedFirstQty)\r",
									"    );\r",
									"  } else {\r",
									"    firstLineMatched = \"false\";\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-038] Behavior recorded (do not hard-fail on provider anomaly)\", function () {\r",
									"  pm.expect(true).to.eq(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc038_status\", String(status));\r",
									"pm.environment.set(\"tc038_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc038_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc038_isJsonObject\", String(isObject));\r",
									"pm.environment.set(\"tc038_userIdEchoed\", String(userIdEchoed));\r",
									"pm.environment.set(\"tc038_firstProductLineMatched\", String(firstLineMatched));\r",
									"pm.environment.set(\r",
									"  \"tc038_behaviorObserved\",\r",
									"  isObject ? \"json_object\" : (hasBody && isJson ? \"json_nonobject\" : (hasBody ? \"nonjson_body\" : \"empty_body\"))\r",
									");\r",
									"pm.environment.set(\"tc038_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userId\": 2,\r\n  \"date\": \"2020-04-01T00:00:00.000Z\",\r\n  \"products\": [\r\n    { \"productId\": 1, \"quantity\": 9 }\r\n  ]\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/carts/{{cartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{cartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-039 | PUT /carts/{id} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-039 | PUT /carts/{id} | ErrorHandling\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text() || \"\";\r",
									"const trimmed = raw.trim();\r",
									"\r",
									"let isJson = false;\r",
									"let tc039Data = null;\r",
									"try {\r",
									"  tc039Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {}\r",
									"\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"// 不強制期待 4xx，因為供應商可能直接 200/201 硬吃\r",
									"pm.test(\"[TC-039] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"const invalidAccepted = [200, 201].includes(status);\r",
									"\r",
									"pm.test(\"[TC-039] Invalid update handling recorded\", function () {\r",
									"  pm.expect(true).to.eq(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc039_status\", String(status));\r",
									"pm.environment.set(\"tc039_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc039_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc039_invalidUpdateAccepted\", String(invalidAccepted));\r",
									"pm.environment.set(\"tc039_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"pm.environment.set(\r",
									"  \"tc039_behaviorObserved\",\r",
									"  invalidAccepted ? \"accepted_invalid_update\" : \"rejected_invalid_update\"\r",
									");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userId\": \"one\",\r\n  \"date\": \"not-a-date\",\r\n  \"products\": \"nope\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/carts/{{cartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{cartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-040 | DELETE /carts/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-040 | DELETE /carts/{id} | Contract\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text().trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc040Data = null;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc040Data = pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-040] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"// Contract: if body exists and is JSON, should be an object and ideally include \"id\"\r",
									"//pm.test(\"[TC-040] Response should be JSON object (or record anomaly)\", function () {\r",
									"//  // Allow empty body (some APIs do that) BUT record it in env\r",
									"//  if (!hasBody) {\r",
									"//    pm.expect(true).to.eql(true);\r",
									"//    return;\r",
									"//  }\r",
									"//  // If body exists, prefer JSON object; if not JSON, we still don't crash\r",
									"//  if (isJson) {\r",
									"//    pm.expect(tc040Data && typeof tc040Data === \"object\" && !Array.isArray(tc040Data)).to.eql(true);\r",
									"//  } else {\r",
									"//    pm.expect(true).to.eql(true);\r",
									"//  }\r",
									"//});\r",
									"pm.test(\"[TC-040] Response should be valid JSON (object or null)\", function () {\r",
									"  if (!hasBody) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  // JSON is acceptable even if null\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc040_status\", String(status));\r",
									"pm.environment.set(\"tc040_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc040_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc040_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc040_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"\r",
									"// Optional contract evidence (do not hard fail)\r",
									"if (hasBody && isJson && tc040Data && typeof tc040Data === \"object\") {\r",
									"  pm.environment.set(\"tc040_hasId\", String(Object.prototype.hasOwnProperty.call(tc040Data, \"id\")));\r",
									"  pm.environment.set(\"tc040_returnedId\", Object.prototype.hasOwnProperty.call(tc040Data, \"id\") ? String(tc040Data.id) : \"\");\r",
									"} else {\r",
									"  pm.environment.set(\"tc040_hasId\", \"N/A\");\r",
									"  pm.environment.set(\"tc040_returnedId\", \"N/A\");\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text",
								"disabled": true
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts/{{cartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{cartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-041 | DELETE /carts/{id} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-041 | DELETE /carts/{id} | Behavior\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text().trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc041Data = null;\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc041Data = pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"const requestedIdRaw = pm.environment.get(\"cartId\");\r",
									"const requestedId = String(requestedIdRaw);\r",
									"\r",
									"// Behavior: 200 is expected for this fake API\r",
									"pm.test(\"[TC-041] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"// Behavior: if JSON object and has id, record if it matches requested\r",
									"let idEchoed = false;\r",
									"let idMatches = \"N/A\";\r",
									"\r",
									"if (hasBody && isJson && tc041Data && typeof tc041Data === \"object\" && !Array.isArray(tc041Data)) {\r",
									"  if (Object.prototype.hasOwnProperty.call(tc041Data, \"id\")) {\r",
									"    idEchoed = true;\r",
									"    idMatches = String(tc041Data.id) === requestedId;\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-041] Delete behavior observed (id echo optional)\", function () {\r",
									"  // Do not fail just because it didn't echo id\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc041_status\", String(status));\r",
									"pm.environment.set(\"tc041_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc041_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc041_idEchoed\", String(idEchoed));\r",
									"pm.environment.set(\"tc041_idMatches\", String(idMatches));\r",
									"pm.environment.set(\"tc041_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"\r",
									"// Summarize behavior label\r",
									"let behaviorObserved = \"unknown\";\r",
									"if (status === 200 && !hasBody) behaviorObserved = \"200_empty_body\";\r",
									"else if (status === 200 && hasBody && isJson) behaviorObserved = \"200_json_body\";\r",
									"else if (status === 200 && hasBody && !isJson) behaviorObserved = \"200_nonjson_body\";\r",
									"else behaviorObserved = \"other_\" + status;\r",
									"\r",
									"pm.environment.set(\"tc041_behaviorObserved\", behaviorObserved);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text",
								"disabled": true
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts/{{cartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{cartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-042 | DELETE /carts/{id} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-042 | DELETE /carts/{id} | ErrorHandling\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text().trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-042] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// For fake APIs, invalid delete might still return 200; record behavior\r",
									"pm.test(\"[TC-042] Invalid delete behavior recorded\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc042_status\", String(status));\r",
									"pm.environment.set(\"tc042_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc042_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc042_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc042_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"\r",
									"let behaviorObserved = \"unknown\";\r",
									"if (status === 404) behaviorObserved = \"proper_404\";\r",
									"else if (status === 200 && !hasBody) behaviorObserved = \"200_empty_body\";\r",
									"else if (status === 200 && hasBody && isJson) behaviorObserved = \"200_json_body\";\r",
									"else if (status === 200 && hasBody && !isJson) behaviorObserved = \"200_nonjson_body\";\r",
									"else behaviorObserved = \"other_\" + status;\r",
									"\r",
									"pm.environment.set(\"tc042_behaviorObserved\", behaviorObserved);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text",
								"disabled": true
							}
						],
						"url": {
							"raw": "{{baseUrl}}/carts/{{cartId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"{{cartId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-043 | GET /carts | Contract (limit)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-043 Contract | GET /carts?limit={{cartLimit}}\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc043Data = null;\r",
									"\r",
									"try {\r",
									"  tc043Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"// Basic\r",
									"pm.test(\"[TC-043] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eq(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-043] Response should be JSON array (or record anomaly)\", function () {\r",
									"  // third-party API: don't crash the runner; record anomaly if not JSON\r",
									"  pm.expect([true, false]).to.include(isJson);\r",
									"  if (isJson) pm.expect(Array.isArray(tc043Data)).to.eq(true);\r",
									"});\r",
									"\r",
									"// Contract checks (guarded)\r",
									"pm.test(\"[TC-043] Contract: each cart should include id, userId, date, products (guarded)\", function () {\r",
									"  if (!isJson || !Array.isArray(tc043Data) || tc043Data.length === 0) {\r",
									"    pm.expect(true).to.eq(true);\r",
									"    return;\r",
									"  }\r",
									"\r",
									"  const first = tc043Data[0];\r",
									"  pm.expect(first && typeof first === \"object\" && !Array.isArray(first)).to.eq(true);\r",
									"\r",
									"  [\"id\", \"userId\", \"date\", \"products\"].forEach((k) => {\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(first, k)).to.eq(true);\r",
									"  });\r",
									"\r",
									"  pm.expect(Array.isArray(first.products)).to.eq(true);\r",
									"\r",
									"  if (first.products.length > 0) {\r",
									"    const p0 = first.products[0];\r",
									"    pm.expect(p0 && typeof p0 === \"object\").to.eq(true);\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(p0, \"productId\")).to.eq(true);\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(p0, \"quantity\")).to.eq(true);\r",
									"  }\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc043_status\", String(status));\r",
									"pm.environment.set(\"tc043_limit\", pm.environment.get(\"cartLimit\"));\r",
									"pm.environment.set(\"tc043_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc043_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc043_isArray\", String(isJson && Array.isArray(tc043Data)));\r",
									"pm.environment.set(\"tc043_count\", String(isJson && Array.isArray(tc043Data) ? tc043Data.length : 0));\r",
									"pm.environment.set(\"tc043_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?limit={{cartLimit}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "limit",
									"value": "{{cartLimit}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-044 | GET /carts | Behavior (limit)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-044 Behavior | GET /carts?limit={{cartLimit}}\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc044Data = null;\r",
									"\r",
									"try {\r",
									"  tc044Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const limitRaw = pm.environment.get(\"cartLimit\");\r",
									"const limitNum = Number(limitRaw);\r",
									"\r",
									"const returnedCount = (isJson && Array.isArray(tc044Data)) ? tc044Data.length : 0;\r",
									"\r",
									"// Basic\r",
									"pm.test(\"[TC-044] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eq(200);\r",
									"});\r",
									"\r",
									"// Behavior check (record, do not hard fail on third-party quirks)\r",
									"pm.test(\"[TC-044] Returned count recorded (limit may be honored or ignored)\", function () {\r",
									"  pm.expect(returnedCount).to.be.at.least(0);\r",
									"  // sanity: limit should be numeric and >0 for this TC\r",
									"  pm.expect(Number.isFinite(limitNum)).to.eq(true);\r",
									"  pm.expect(limitNum).to.be.greaterThan(0);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"const limitHonored = (returnedCount === limitNum);\r",
									"\r",
									"pm.environment.set(\"tc044_status\", String(status));\r",
									"pm.environment.set(\"tc044_limit\", String(limitRaw));\r",
									"pm.environment.set(\"tc044_returnedCount\", String(returnedCount));\r",
									"pm.environment.set(\"tc044_limitHonored\", String(limitHonored));\r",
									"\r",
									"// Optional: quick hint text for later report writing\r",
									"pm.environment.set(\r",
									"  \"tc044_behaviorObserved\",\r",
									"  limitHonored ? \"honored\" : \"ignored_or_defaulted\"\r",
									");\r",
									"pm.environment.set(\"tc044_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?limit={{cartLimit}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "limit",
									"value": "{{cartLimit}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-045 | GET /carts | ErrorHandling (limit)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-045 ErrorHandling | GET /carts?limit={{invalidCartLimit}}\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc045Data = null;\r",
									"\r",
									"try {\r",
									"  tc045Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-045] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// If still 200 and returns array, likely ignored invalid limit\r",
									"const returnedCount = (isJson && Array.isArray(tc045Data)) ? tc045Data.length : 0;\r",
									"const invalidLimit = pm.environment.get(\"invalidCartLimit\");\r",
									"\r",
									"let behavior = \"unknown\";\r",
									"if (status >= 400 && status < 500) behavior = \"rejected_invalid_limit\";\r",
									"else if (status === 200 && isJson && Array.isArray(tc045Data)) behavior = \"ignored_invalid_limit_returned_list\";\r",
									"else if (status === 200 && !hasBody) behavior = \"ignored_invalid_limit_empty_body\";\r",
									"else behavior = \"other_\" + status;\r",
									"\r",
									"pm.test(\"[TC-045] Invalid limit behavior recorded\", function () {\r",
									"  pm.expect(true).to.eq(true); // observation-based\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc045_status\", String(status));\r",
									"pm.environment.set(\"tc045_invalidLimit\", String(invalidLimit));\r",
									"pm.environment.set(\"tc045_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc045_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc045_returnedCount\", String(returnedCount));\r",
									"pm.environment.set(\"tc045_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc045_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?limit={{invalidCartLimit}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "limit",
									"value": "{{invalidCartLimit}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-046 | GET /carts | Contract (sort)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-046 | GET /carts | Contract (sort)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"// Parse JSON safely\r",
									"let isJson = false;\r",
									"let tc046Data = null;\r",
									"try {\r",
									"  tc046Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc046Data);\r",
									"\r",
									"pm.test(\"[TC-046] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-046] Response should be JSON array\", function () {\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"// Contract (guarded)\r",
									"pm.test(\"[TC-046] Contract: cart items should include id, userId, date, products (guarded)\", function () {\r",
									"  if (!isArray) {\r",
									"    pm.expect(true).to.eql(true); // don't crash; schema can't be checked\r",
									"    return;\r",
									"  }\r",
									"  tc046Data.forEach((item, idx) => {\r",
									"    pm.expect(item, `item[${idx}] should be object`).to.be.an(\"object\");\r",
									"    [\"id\", \"userId\", \"date\", \"products\"].forEach((k) => {\r",
									"      pm.expect(item, `item[${idx}] should have ${k}`).to.have.property(k);\r",
									"    });\r",
									"  });\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-046] Contract: products should be array and include productId & quantity (guarded)\", function () {\r",
									"  if (!isArray) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  tc046Data.forEach((item, idx) => {\r",
									"    if (!Array.isArray(item.products)) return; // avoid crash; still record below\r",
									"    item.products.forEach((p, pIdx) => {\r",
									"      pm.expect(p, `item[${idx}].products[${pIdx}] should be object`).to.be.an(\"object\");\r",
									"      pm.expect(p).to.have.property(\"productId\");\r",
									"      pm.expect(p).to.have.property(\"quantity\");\r",
									"    });\r",
									"  });\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc046_status\", String(status));\r",
									"pm.environment.set(\"tc046_sort\", String(pm.environment.get(\"cartSort\") || \"\"));\r",
									"pm.environment.set(\"tc046_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc046_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc046_count\", String(isArray ? tc046Data.length : 0));\r",
									"pm.environment.set(\"tc046_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?sort={{cartSort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{cartSort}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-047 | GET /carts | Behavior (sort)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-047 | GET /carts | Behavior (sort)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc047Data = null;\r",
									"try {\r",
									"  tc047Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const sort = String(pm.environment.get(\"cartSort\") || \"asc\").toLowerCase();\r",
									"const isArray = isJson && Array.isArray(tc047Data);\r",
									"\r",
									"pm.test(\"[TC-047] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-047] Response should be JSON array (or record anomaly)\", function () {\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"// Determine if order is monotonic by id\r",
									"function isMonotonicById(arr, dir) {\r",
									"  if (!Array.isArray(arr) || arr.length <= 1) return true;\r",
									"  for (let i = 1; i < arr.length; i++) {\r",
									"    const prev = Number(arr[i - 1]?.id);\r",
									"    const cur = Number(arr[i]?.id);\r",
									"    if (!Number.isFinite(prev) || !Number.isFinite(cur)) return false;\r",
									"    if (dir === \"asc\" && cur < prev) return false;\r",
									"    if (dir === \"desc\" && cur > prev) return false;\r",
									"  }\r",
									"  return true;\r",
									"}\r",
									"\r",
									"let orderValid = null;\r",
									"if (isArray) {\r",
									"  orderValid = isMonotonicById(tc047Data, sort);\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-047] Verify sort order by id (guarded)\", function () {\r",
									"  if (!isArray) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  // If API ignores sort, this can be false; we still want the test to reflect behavior clearly.\r",
									"  pm.expect(orderValid).to.be.oneOf([true, false]);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc047_status\", String(status));\r",
									"pm.environment.set(\"tc047_sort\", String(sort));\r",
									"pm.environment.set(\"tc047_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc047_count\", String(isArray ? tc047Data.length : 0));\r",
									"pm.environment.set(\"tc047_orderValidById\", String(orderValid));\r",
									"pm.environment.set(\"tc047_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?sort={{cartSort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{cartSort}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-048 | GET /carts | ErrorHandling (sort)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-048 | GET /carts | ErrorHandling (sort)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc048Data = null;\r",
									"try {\r",
									"  tc048Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const invalidSort = String(pm.environment.get(\"invalidCartSort\") || \"\");\r",
									"const isArray = isJson && Array.isArray(tc048Data);\r",
									"const returnedCount = isArray ? tc048Data.length : 0;\r",
									"\r",
									"// Observation: does invalid sort get ignored?\r",
									"let behavior = \"unknown\";\r",
									"if (status >= 500) behavior = \"server_error\";\r",
									"else if (status >= 400) behavior = \"client_error\";\r",
									"else if (status === 200 && isArray) behavior = \"ignored_invalid_sort_returned_list\";\r",
									"else if (status === 200 && hasBody) behavior = \"200_non_array_body\";\r",
									"else behavior = \"other_\" + status;\r",
									"\r",
									"pm.test(\"[TC-048] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-048] Invalid sort behavior recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc048_status\", String(status));\r",
									"pm.environment.set(\"tc048_invalidSort\", String(invalidSort));\r",
									"pm.environment.set(\"tc048_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc048_returnedCount\", String(returnedCount));\r",
									"pm.environment.set(\"tc048_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc048_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?sort={{invalidCartSort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{invalidCartSort}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-049 | GET /carts/user/{userId} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.trim().length > 0;\r",
									"\r",
									"let tc049Data = null;\r",
									"let isJson = false;\r",
									"try {\r",
									"  tc049Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"// ---- Contract assertions (guarded) ----\r",
									"pm.test(\"[TC-049] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-049] Response should be JSON array (or record anomaly)\", function () {\r",
									"  // FakeStore 多數情況會是 JSON array；若不是也不要直接 TypeError\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc049Data);\r",
									"\r",
									"pm.test(\"[TC-049] Contract: response should be an array (guarded)\", function () {\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-049] Contract: cart item should include id,userId,date,products (guarded)\", function () {\r",
									"  if (!isArray) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  if (tc049Data.length === 0) {\r",
									"    // 合法：此 user 可能沒有 carts（記錄即可）\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"\r",
									"  const c = tc049Data[0];\r",
									"  pm.expect(c).to.be.an(\"object\");\r",
									"  [\"id\", \"userId\", \"date\", \"products\"].forEach(k => pm.expect(c).to.have.property(k));\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-049] Contract: products items should include productId & quantity (guarded)\", function () {\r",
									"  if (!isArray || tc049Data.length === 0) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  const c = tc049Data[0];\r",
									"  if (!Array.isArray(c.products) || c.products.length === 0) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  const p = c.products[0];\r",
									"  pm.expect(p).to.be.an(\"object\");\r",
									"  [\"productId\", \"quantity\"].forEach(k => pm.expect(p).to.have.property(k));\r",
									"});\r",
									"\r",
									"// ---- Evidence ----\r",
									"pm.environment.set(\"tc049_status\", String(status));\r",
									"pm.environment.set(\"tc049_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc049_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc049_userId\", String(pm.environment.get(\"cartUserId\")));\r",
									"pm.environment.set(\"tc049_count\", String(isArray ? tc049Data.length : 0));\r",
									"pm.environment.set(\"tc049_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts/user/{{cartUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"user",
								"{{cartUserId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-050 | GET /carts/user/{userId} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"//TC-050 | GET /carts/user/{userId} | Behavior\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.trim().length > 0;\r",
									"\r",
									"let tc050Data = null;\r",
									"let isJson = false;\r",
									"try { tc050Data = pm.response.json(); isJson = true; } catch (e) { isJson = false; }\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc050Data);\r",
									"const expectedUserIdRaw = pm.environment.get(\"cartUserId\");\r",
									"const expectedUserId = String(expectedUserIdRaw);\r",
									"\r",
									"pm.test(\"[TC-050] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-050] Response should be JSON array (or record anomaly)\", function () {\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"let allMatch = null; // null = N/A\r",
									"if (isArray) {\r",
									"  if (tc050Data.length === 0) {\r",
									"    allMatch = null; // 沒資料無法驗證 filter，但不是錯\r",
									"  } else {\r",
									"    allMatch = tc050Data.every(c => c && typeof c === \"object\" && String(c.userId) === expectedUserId);\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-050] All returned carts should match requested userId (guarded)\", function () {\r",
									"  if (allMatch === null) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  pm.expect(allMatch).to.eql(true);\r",
									"});\r",
									"\r",
									"// ---- Evidence ----\r",
									"pm.environment.set(\"tc050_status\", String(status));\r",
									"pm.environment.set(\"tc050_userId\", expectedUserId);\r",
									"pm.environment.set(\"tc050_count\", String(isArray ? tc050Data.length : 0));\r",
									"pm.environment.set(\"tc050_allMatch\", String(allMatch));\r",
									"pm.environment.set(\"tc050_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts/user/{{cartUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"user",
								"{{cartUserId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-051 | GET /carts/user/{userId} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"//TC-051 | GET /carts/user/{userId} | ErrorHandling\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.trim().length > 0;\r",
									"\r",
									"let tc051Data = null;\r",
									"let isJson = false;\r",
									"try { tc051Data = pm.response.json(); isJson = true; } catch (e) { isJson = false; }\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc051Data);\r",
									"const returnedCount = isArray ? tc051Data.length : 0;\r",
									"const invalidUserId = pm.environment.get(\"invalidCartUserId\");\r",
									"\r",
									"pm.test(\"[TC-051] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-051] Invalid userId behavior recorded (observation-based)\", function () {\r",
									"  // 不強制 4xx，避免跟 FakeStore 實際行為打架\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"let behavior = \"unknown\";\r",
									"if (status === 200 && isArray && returnedCount === 0) behavior = \"200_empty_list\";\r",
									"else if (status === 200 && isArray && returnedCount > 0) behavior = \"200_nonempty_list\";\r",
									"else if (status >= 400 && status < 500) behavior = \"4xx\";\r",
									"else if (status >= 500) behavior = \"5xx\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"// ---- Evidence ----\r",
									"pm.environment.set(\"tc051_status\", String(status));\r",
									"pm.environment.set(\"tc051_invalidUserId\", String(invalidUserId));\r",
									"pm.environment.set(\"tc051_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc051_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc051_returnedCount\", String(returnedCount));\r",
									"pm.environment.set(\"tc051_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc051_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts/user/{{invalidCartUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts",
								"user",
								"{{invalidCartUserId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-052 | GET /carts | Contract (date-range)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-052 | Contract | GET /carts (date-range)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = (pm.response.text() || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc052Data = null;\r",
									"let isJson = false;\r",
									"try { tc052Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc052Data);\r",
									"\r",
									"pm.test(\"[TC-052] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-052] Response should be JSON array (or record anomaly)\", function () {\r",
									"  // guarded: do not crash even if API returns weird stuff\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"// Contract check: only validate item keys if list has items\r",
									"pm.test(\"[TC-052] Contract: cart item should include id, userId, date, products (guarded)\", function () {\r",
									"  if (!isArray || tc052Data.length === 0) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  const item = tc052Data[0];\r",
									"  pm.expect(item && typeof item === \"object\").to.eql(true);\r",
									"  [\"id\", \"userId\", \"date\", \"products\"].forEach(k => {\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(item, k)).to.eql(true);\r",
									"  });\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-052] Contract: products items include productId & quantity (guarded)\", function () {\r",
									"  if (!isArray || tc052Data.length === 0) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  const item = tc052Data[0];\r",
									"  if (!item || typeof item !== \"object\" || !Array.isArray(item.products) || item.products.length === 0) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  const p = item.products[0];\r",
									"  pm.expect(p && typeof p === \"object\").to.eql(true);\r",
									"  [\"productId\", \"quantity\"].forEach(k => {\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(p, k)).to.eql(true);\r",
									"  });\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc052_status\", String(status));\r",
									"pm.environment.set(\"tc052_startdate\", String(pm.environment.get(\"cartStartDate\")));\r",
									"pm.environment.set(\"tc052_enddate\", String(pm.environment.get(\"cartEndDate\")));\r",
									"pm.environment.set(\"tc052_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc052_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc052_count\", String(isArray ? tc052Data.length : 0));\r",
									"pm.environment.set(\"tc052_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?startdate={{cartStartDate}}&enddate={{cartEndDate}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "startdate",
									"value": "{{cartStartDate}}"
								},
								{
									"key": "enddate",
									"value": "{{cartEndDate}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-053 | GET /carts | Behavior (date-range)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-053 | Behavior | GET /carts (date-range)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = (pm.response.text() || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc053Data = null;\r",
									"let isJson = false;\r",
									"try { tc053Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc053Data);\r",
									"\r",
									"const startRaw = pm.environment.get(\"cartStartDate\");\r",
									"const endRaw = pm.environment.get(\"cartEndDate\");\r",
									"\r",
									"// Parse YYYY-MM-DD into Date (UTC midnight)\r",
									"function parseYmd(ymd) {\r",
									"  if (typeof ymd !== \"string\") return null;\r",
									"  const m = /^(\\d{4})-(\\d{2})-(\\d{2})$/.exec(ymd);\r",
									"  if (!m) return null;\r",
									"  const iso = `${m[1]}-${m[2]}-${m[3]}T00:00:00.000Z`;\r",
									"  const d = new Date(iso);\r",
									"  return isNaN(d.getTime()) ? null : d;\r",
									"}\r",
									"\r",
									"// Response \"date\" is usually ISO string; keep it tolerant\r",
									"function parseApiDate(s) {\r",
									"  if (typeof s !== \"string\") return null;\r",
									"  const d = new Date(s);\r",
									"  return isNaN(d.getTime()) ? null : d;\r",
									"}\r",
									"\r",
									"const startD = parseYmd(startRaw);\r",
									"const endD = parseYmd(endRaw);\r",
									"\r",
									"pm.test(\"[TC-053] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-053] Response should be JSON array (or record anomaly)\", function () {\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"// Behavior: verify every returned cart.date is within [start, end] if API honors filter.\r",
									"// If API ignores filter, we DO NOT fail hard — we record observation.\r",
									"let withinRangeAll = null;   // true/false/null (null = cannot evaluate)\r",
									"let datesParsedCount = 0;\r",
									"\r",
									"if (isArray && startD && endD) {\r",
									"  let ok = true;\r",
									"  for (const item of tc053Data) {\r",
									"    const d = item && typeof item === \"object\" ? parseApiDate(item.date) : null;\r",
									"    if (!d) continue; // cannot evaluate this item, keep going\r",
									"    datesParsedCount += 1;\r",
									"\r",
									"    // inclusive range: start <= d <= end+1day? (end is date-only, API date includes time)\r",
									"    // Use endD + 1 day minus 1ms to include entire end date.\r",
									"    const endInclusive = new Date(endD.getTime() + 24 * 60 * 60 * 1000 - 1);\r",
									"\r",
									"    if (!(d >= startD && d <= endInclusive)) {\r",
									"      ok = false;\r",
									"      break;\r",
									"    }\r",
									"  }\r",
									"  withinRangeAll = (datesParsedCount > 0) ? ok : null;\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-053] Date range filtering observed (record evidence, do not enforce)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc053_status\", String(status));\r",
									"pm.environment.set(\"tc053_startdate\", String(startRaw));\r",
									"pm.environment.set(\"tc053_enddate\", String(endRaw));\r",
									"pm.environment.set(\"tc053_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc053_count\", String(isArray ? tc053Data.length : 0));\r",
									"pm.environment.set(\"tc053_datesParsedCount\", String(datesParsedCount));\r",
									"pm.environment.set(\"tc053_withinRangeAll\", String(withinRangeAll)); // \"true\"/\"false\"/\"null\"\r",
									"\r",
									"let behavior = \"unknown\";\r",
									"if (status === 200 && isArray) {\r",
									"  if (withinRangeAll === true) behavior = \"honored_range\";\r",
									"  else if (withinRangeAll === false) behavior = \"not_honored_range\";\r",
									"  else behavior = \"cannot_evaluate_range\";\r",
									"} else if (status >= 400 && status < 500) behavior = \"4xx\";\r",
									"else if (status >= 500) behavior = \"5xx\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.environment.set(\"tc053_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc053_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?startdate={{cartStartDate}}&enddate={{cartEndDate}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "startdate",
									"value": "{{cartStartDate}}"
								},
								{
									"key": "enddate",
									"value": "{{cartEndDate}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-054 | GET /carts | ErrorHandling (date-range)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-054 | ErrorHandling | GET /carts (date-range)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = (pm.response.text() || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc054Data = null;\r",
									"let isJson = false;\r",
									"try { tc054Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc054Data);\r",
									"\r",
									"pm.test(\"[TC-054] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-054] Invalid date handling recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"const invalidStart = pm.environment.get(\"invalidStartDate\");\r",
									"const invalidEnd = pm.environment.get(\"invalidEndDate\");\r",
									"\r",
									"pm.environment.set(\"tc054_status\", String(status));\r",
									"pm.environment.set(\"tc054_invalidStartDate\", String(invalidStart));\r",
									"pm.environment.set(\"tc054_invalidEndDate\", String(invalidEnd));\r",
									"pm.environment.set(\"tc054_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc054_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc054_returnedCount\", String(isArray ? tc054Data.length : 0));\r",
									"pm.environment.set(\"tc054_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"\r",
									"// classify behavior\r",
									"let behavior = \"unknown\";\r",
									"if (status >= 400 && status < 500) behavior = \"4xx_rejected_invalid_date\";\r",
									"else if (status === 200 && isArray && tc054Data.length === 0) behavior = \"200_empty_list\";\r",
									"else if (status === 200 && isArray && tc054Data.length > 0) behavior = \"ignored_invalid_date_returned_list\";\r",
									"else if (status === 200 && hasBody && !isJson) behavior = \"200_non_json_body\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.environment.set(\"tc054_behaviorObserved\", behavior);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/carts?startdate={{invalidStartDate}}&enddate={{invalidStartDate}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"carts"
							],
							"query": [
								{
									"key": "startdate",
									"value": "{{invalidStartDate}}"
								},
								{
									"key": "enddate",
									"value": "{{invalidStartDate}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "03_Users",
			"item": [
				{
					"name": "TC-055 | GET /users | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-055 | GET /users | Contract\r",
									"// Goal: Validate user list schema (observation-friendly & guarded)\r",
									"\r",
									"const status = pm.response.code;\r",
									"\r",
									"// raw + trimmed\r",
									"const raw = pm.response.text() || \"\";\r",
									"const trimmed = raw.trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc055Data = null;\r",
									"let isJson = false;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc055Data = pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"    tc055Data = null;\r",
									"  }\r",
									"}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc055Data);\r",
									"const count = isArray ? tc055Data.length : 0;\r",
									"\r",
									"// ---- Tests ----\r",
									"pm.test(\"[TC-055] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-055] Response should be JSON array (or record anomaly)\", function () {\r",
									"  // We assert JSON+array if body exists; otherwise we still don't crash.\r",
									"  if (!hasBody) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(Array.isArray(tc055Data)).to.eql(true);\r",
									"});\r",
									"\r",
									"// Contract checks (guarded)\r",
									"pm.test(\"[TC-055] Contract: each user should include basic keys (guarded)\", function () {\r",
									"  if (!(hasBody && isArray)) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"\r",
									"  // check first N to avoid heavy loops\r",
									"  const N = Math.min(count, 5);\r",
									"  for (let i = 0; i < N; i++) {\r",
									"    const u = tc055Data[i];\r",
									"\r",
									"    // allow null anomaly without throwing\r",
									"    if (u === null || u === undefined || typeof u !== \"object\" || Array.isArray(u)) {\r",
									"      continue;\r",
									"    }\r",
									"\r",
									"    // FakeStore user typical keys:\r",
									"    // id, email, username, password, name{firstname,lastname}, address{...}, phone\r",
									"    [\"id\", \"email\", \"username\", \"password\", \"name\", \"address\", \"phone\"].forEach((k) => {\r",
									"      pm.expect(Object.prototype.hasOwnProperty.call(u, k)).to.eql(true);\r",
									"    });\r",
									"\r",
									"    // nested checks\r",
									"    pm.expect(typeof u.name).to.eql(\"object\");\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(u.name, \"firstname\")).to.eql(true);\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(u.name, \"lastname\")).to.eql(true);\r",
									"\r",
									"    pm.expect(typeof u.address).to.eql(\"object\");\r",
									"    [\"city\", \"street\", \"number\", \"zipcode\", \"geolocation\"].forEach((k) => {\r",
									"      pm.expect(Object.prototype.hasOwnProperty.call(u.address, k)).to.eql(true);\r",
									"    });\r",
									"\r",
									"    pm.expect(typeof u.address.geolocation).to.eql(\"object\");\r",
									"    [\"lat\", \"long\"].forEach((k) => {\r",
									"      pm.expect(Object.prototype.hasOwnProperty.call(u.address.geolocation, k)).to.eql(true);\r",
									"    });\r",
									"  }\r",
									"});\r",
									"\r",
									"// ---- Evidence (Variables) ----\r",
									"pm.environment.set(\"tc055_status\", String(status));\r",
									"pm.environment.set(\"tc055_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc055_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc055_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc055_count\", String(count));\r",
									"\r",
									"// small head sample for quick audit\r",
									"pm.environment.set(\"tc055_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-056 | GET /users | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-056 | GET /users | Behavior\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc056Data = null;\r",
									"let isJson = false;\r",
									"try {\r",
									"  tc056Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc056Data);\r",
									"const count = isArray ? tc056Data.length : 0;\r",
									"\r",
									"// --- Basic checks (behavior expectation) ---\r",
									"pm.test(\"[TC-056] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-056] Response should be JSON array (or record anomaly)\", function () {\r",
									"  // We don't crash even if API is weird\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// --- Behavior checks (guarded) ---\r",
									"pm.test(\"[TC-056] List should be non-empty (observation-based)\", function () {\r",
									"  // FakeStore should normally return users; if 0, record but don't hard-fail the whole run\r",
									"  pm.expect(count).to.be.at.least(0);\r",
									"});\r",
									"\r",
									"let firstHasId = \"N/A\";\r",
									"let idsUnique = \"N/A\";\r",
									"let emailLooksOk = \"N/A\";\r",
									"\r",
									"if (isArray && count > 0) {\r",
									"  // first item sanity\r",
									"  const u0 = tc056Data[0];\r",
									"  firstHasId = (u0 && typeof u0 === \"object\" && Object.prototype.hasOwnProperty.call(u0, \"id\")) ? \"true\" : \"false\";\r",
									"\r",
									"  // uniqueness of ids (guarded sample)\r",
									"  const sampleN = Math.min(count, 10);\r",
									"  const ids = [];\r",
									"  for (let i = 0; i < sampleN; i++) {\r",
									"    const u = tc056Data[i];\r",
									"    if (u && typeof u === \"object\" && Object.prototype.hasOwnProperty.call(u, \"id\")) {\r",
									"      ids.push(String(u.id));\r",
									"    }\r",
									"  }\r",
									"  idsUnique = (new Set(ids).size === ids.length) ? \"true\" : \"false\";\r",
									"\r",
									"  // email format quick check (very loose, guarded)\r",
									"  const sampleEmails = [];\r",
									"  for (let i = 0; i < sampleN; i++) {\r",
									"    const u = tc056Data[i];\r",
									"    if (u && typeof u === \"object\" && typeof u.email === \"string\") {\r",
									"      sampleEmails.push(u.email);\r",
									"    }\r",
									"  }\r",
									"  emailLooksOk = sampleEmails.every(e => e.includes(\"@\")) ? \"true\" : \"false\";\r",
									"}\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc056_status\", String(status));\r",
									"pm.environment.set(\"tc056_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc056_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc056_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc056_count\", String(count));\r",
									"\r",
									"pm.environment.set(\"tc056_firstHasId\", String(firstHasId));\r",
									"pm.environment.set(\"tc056_idsUniqueSample10\", String(idsUnique));\r",
									"pm.environment.set(\"tc056_emailLooksOkSample10\", String(emailLooksOk));\r",
									"\r",
									"pm.environment.set(\"tc056_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-057 | GET /users | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-057 | GET /users | ErrorHandling\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc057Data = null;\r",
									"try {\r",
									"  tc057Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc057Data);\r",
									"const returnedCount = isArray ? tc057Data.length : 0;\r",
									"\r",
									"// Guard: should not be 5xx\r",
									"pm.test(\"[TC-057] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// Observation-based classification\r",
									"let behavior = \"unknown\";\r",
									"if (status >= 400 && status < 500) behavior = \"4xx\";\r",
									"else if (status >= 500) behavior = \"5xx\";\r",
									"else if (status === 200 && isArray) behavior = \"200_array\";\r",
									"else if (status === 200 && isJson && !isArray) behavior = \"200_json_nonarray\";\r",
									"else if (status === 200 && !isJson) behavior = \"200_non_json\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.test(\"[TC-057] Error handling behavior recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc057_status\", String(status));\r",
									"pm.environment.set(\"tc057_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc057_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc057_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc057_returnedCount\", String(returnedCount));\r",
									"pm.environment.set(\"tc057_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc057_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-058 | POST /users | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc058Data = null;\r",
									"try { tc058Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"pm.test(\"[TC-058] Status should be 200/201 (observation-based)\", function () {\r",
									"  pm.expect([200, 201]).to.include(status);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-058] Response should be JSON object (or record anomaly)\", function () {\r",
									"  if (!hasBody) { pm.expect(true).to.eql(true); return; }\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  // allow null weirdness, but don't crash\r",
									"  pm.expect(tc058Data === null || typeof tc058Data === \"object\").to.eql(true);\r",
									"});\r",
									"\r",
									"// Contract-ish checks (guarded)\r",
									"pm.test(\"[TC-058] Contract: if object, should include id or basic keys (guarded)\", function () {\r",
									"  if (!hasBody || !isJson || tc058Data === null || typeof tc058Data !== \"object\" || Array.isArray(tc058Data)) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  // Many FakeStore endpoints return at least { id: ... }\r",
									"  const hasId = Object.prototype.hasOwnProperty.call(tc058Data, \"id\");\r",
									"  const hasUsername = Object.prototype.hasOwnProperty.call(tc058Data, \"username\");\r",
									"  const hasEmail = Object.prototype.hasOwnProperty.call(tc058Data, \"email\");\r",
									"  pm.expect(hasId || hasUsername || hasEmail).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc058_status\", String(status));\r",
									"pm.environment.set(\"tc058_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc058_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc058_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc058_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"\r",
									"let createdId = \"\";\r",
									"if (hasBody && isJson && tc058Data && typeof tc058Data === \"object\" && !Array.isArray(tc058Data) && Object.prototype.hasOwnProperty.call(tc058Data, \"id\")) {\r",
									"  createdId = String(tc058Data.id);\r",
									"  pm.environment.set(\"createdUserId\", createdId);\r",
									"}\r",
									"pm.environment.set(\"tc058_createdUserId\", createdId || \"N/A\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"alvin.tc058@example.com\",\r\n  \"username\": \"alvin_tc058\",\r\n  \"password\": \"pass1234\",\r\n  \"name\": { \"firstname\": \"Alvin\", \"lastname\": \"Tester\" },\r\n  \"address\": {\r\n    \"city\": \"Taipei\",\r\n    \"street\": \"Xinyi Rd\",\r\n    \"number\": 1,\r\n    \"zipcode\": \"110\",\r\n    \"geolocation\": { \"lat\": \"25.0330\", \"long\": \"121.5654\" }\r\n  },\r\n  \"phone\": \"0912345678\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-059 | POST /users | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"//TC-059 | POST /users | Behavior\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc059Data = null;\r",
									"try { tc059Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"pm.test(\"[TC-059] Status should be 200/201\", function () {\r",
									"  pm.expect([200, 201]).to.include(status);\r",
									"});\r",
									"\r",
									"let hasId = false;\r",
									"let echoedUsername = false;\r",
									"let echoedEmail = false;\r",
									"\r",
									"if (hasBody && isJson && tc059Data && typeof tc059Data === \"object\" && !Array.isArray(tc059Data)) {\r",
									"  hasId = Object.prototype.hasOwnProperty.call(tc059Data, \"id\");\r",
									"  echoedUsername = Object.prototype.hasOwnProperty.call(tc059Data, \"username\");\r",
									"  echoedEmail = Object.prototype.hasOwnProperty.call(tc059Data, \"email\");\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-059] Behavior recorded: id generated or fields echoed (guarded)\", function () {\r",
									"  // Do not fail hard: record observation\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc059_status\", String(status));\r",
									"pm.environment.set(\"tc059_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc059_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc059_hasId\", String(hasId));\r",
									"pm.environment.set(\"tc059_echoedUsername\", String(echoedUsername));\r",
									"pm.environment.set(\"tc059_echoedEmail\", String(echoedEmail));\r",
									"pm.environment.set(\"tc059_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"\r",
									"const behavior =\r",
									"  status >= 500 ? \"5xx\" :\r",
									"  ([200, 201].includes(status) && hasBody && isJson && tc059Data === null) ? \"200_json_null\" :\r",
									"  ([200, 201].includes(status) && hasBody && isJson && typeof tc059Data === \"object\") ? \"200_json_object\" :\r",
									"  ([200, 201].includes(status) && !hasBody) ? \"200_empty_body\" :\r",
									"  `other_${status}`;\r",
									"\r",
									"pm.environment.set(\"tc059_behaviorObserved\", behavior);\r",
									"\r",
									"if (hasId && tc059Data && Object.prototype.hasOwnProperty.call(tc059Data, \"id\")) {\r",
									"  pm.environment.set(\"createdUserId\", String(tc059Data.id));\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"alvin.tc059@example.com\",\r\n  \"username\": \"alvin_tc059\",\r\n  \"password\": \"pass1234\",\r\n  \"name\": { \"firstname\": \"Alvin\", \"lastname\": \"Tester\" },\r\n  \"address\": {\r\n    \"city\": \"Taipei\",\r\n    \"street\": \"Xinyi Rd\",\r\n    \"number\": 2,\r\n    \"zipcode\": \"110\",\r\n    \"geolocation\": { \"lat\": \"25.0330\", \"long\": \"121.5654\" }\r\n  },\r\n  \"phone\": \"0912345678\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-060 | POST /users | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"//TC-060 | POST /users | ErrorHandling\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text() || \"\";\r",
									"const hasBody = trimmed.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc060Data = null;\r",
									"try { tc060Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"// Minimal safety: don't allow 5xx\r",
									"pm.test(\"[TC-060] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// Record whether invalid body got accepted\r",
									"const accepted = [200, 201].includes(status);\r",
									"\r",
									"pm.test(\"[TC-060] Invalid body behavior recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc060_status\", String(status));\r",
									"pm.environment.set(\"tc060_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc060_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc060_invalidBodyAccepted\", String(accepted));\r",
									"pm.environment.set(\"tc060_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"\r",
									"let behavior = \"unknown\";\r",
									"if (status >= 500) behavior = \"5xx\";\r",
									"else if (status >= 400 && status < 500) behavior = \"4xx_rejected_invalid_body\";\r",
									"else if (accepted && hasBody && isJson && (tc060Data === null || typeof tc060Data === \"object\")) behavior = \"accepted_invalid_body_json\";\r",
									"else if (accepted && !hasBody) behavior = \"accepted_invalid_body_empty\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.environment.set(\"tc060_behaviorObserved\", behavior);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": 123,\r\n  \"email\": \"not-an-email\",\r\n  \"password\": null,\r\n  \"name\": \"nope\",\r\n  \"address\": \"nope\",\r\n  \"phone\": {}\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-061 | GET /users/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-061 | GET /users/{id} | Contract\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"\r",
									"let tc061Data = null;\r",
									"let isJson = false;\r",
									"try {\r",
									"  tc061Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const hasBody = trimmed.length > 0;\r",
									"const isObject = isJson && tc061Data !== null && typeof tc061Data === \"object\" && !Array.isArray(tc061Data);\r",
									"\r",
									"pm.test(\"[TC-061] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-061] Response should be JSON object (or record anomaly)\", function () {\r",
									"  // Hard guard: we expect object, but avoid throwing TypeError when API returns null\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(isObject).to.eql(true);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-061] Contract: should include basic keys (guarded)\", function () {\r",
									"  if (!isObject) {\r",
									"    pm.expect.fail(\"Response is not a JSON object (null/array/non-json).\");\r",
									"  }\r",
									"  [\"id\", \"email\", \"username\", \"name\", \"address\", \"phone\"].forEach((k) => {\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(tc061Data, k)).to.eql(true);\r",
									"  });\r",
									"\r",
									"  // nested minimal checks\r",
									"  pm.expect(typeof tc061Data.name).to.eql(\"object\");\r",
									"  [\"firstname\", \"lastname\"].forEach((k) => {\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(tc061Data.name, k)).to.eql(true);\r",
									"  });\r",
									"\r",
									"  pm.expect(typeof tc061Data.address).to.eql(\"object\");\r",
									"  [\"city\", \"street\", \"number\", \"zipcode\", \"geolocation\"].forEach((k) => {\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(tc061Data.address, k)).to.eql(true);\r",
									"  });\r",
									"\r",
									"  pm.expect(typeof tc061Data.address.geolocation).to.eql(\"object\");\r",
									"  [\"lat\", \"long\"].forEach((k) => {\r",
									"    pm.expect(Object.prototype.hasOwnProperty.call(tc061Data.address.geolocation, k)).to.eql(true);\r",
									"  });\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc061_status\", String(status));\r",
									"pm.environment.set(\"tc061_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc061_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc061_isJsonObject\", String(isObject));\r",
									"pm.environment.set(\"tc061_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-062 | GET /users/{id} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-062 | GET /users/{id} | Behavior\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"\r",
									"let tc062Data = null;\r",
									"let isJson = false;\r",
									"try {\r",
									"  tc062Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const hasBody = trimmed.length > 0;\r",
									"const isObject = isJson && tc062Data !== null && typeof tc062Data === \"object\" && !Array.isArray(tc062Data);\r",
									"\r",
									"const expectedId = pm.variables.get(\"userId\"); // from env/request variable\r",
									"\r",
									"pm.test(\"[TC-062] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-062] Response should be JSON (if body exists)\", function () {\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-062] Returned id should match requested userId (guarded)\", function () {\r",
									"  if (!isObject) {\r",
									"    pm.expect.fail(\"Response is not a JSON object (null/array/non-json).\");\r",
									"  }\r",
									"  pm.expect(String(tc062Data.id)).to.eql(String(expectedId));\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-062] Username/email should be non-empty strings (guarded)\", function () {\r",
									"  if (!isObject) {\r",
									"    pm.expect.fail(\"Response is not a JSON object (null/array/non-json).\");\r",
									"  }\r",
									"  pm.expect(tc062Data.username).to.be.a(\"string\").and.not.empty;\r",
									"  pm.expect(tc062Data.email).to.be.a(\"string\").and.not.empty;\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc062_status\", String(status));\r",
									"pm.environment.set(\"tc062_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc062_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc062_expectedUserId\", String(expectedId));\r",
									"pm.environment.set(\"tc062_idMatches\", String(isObject ? String(tc062Data.id) === String(expectedId) : \"N/A\"));\r",
									"pm.environment.set(\"tc062_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-063 | GET /users/{id} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-063 | GET /users/{id} | ErrorHandling\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"\r",
									"let tc063Data = null;\r",
									"let isJson = false;\r",
									"try {\r",
									"  tc063Data = pm.response.json();\r",
									"  isJson = true;\r",
									"} catch (e) {\r",
									"  isJson = false;\r",
									"}\r",
									"\r",
									"const hasBody = trimmed.length > 0;\r",
									"const isObject = isJson && tc063Data !== null && typeof tc063Data === \"object\" && !Array.isArray(tc063Data);\r",
									"const isArray = isJson && Array.isArray(tc063Data);\r",
									"\r",
									"pm.test(\"[TC-063] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// Observation-based classification (do not fail)\r",
									"let behavior = \"unknown\";\r",
									"if (status === 404) behavior = \"404_not_found\";\r",
									"else if (status >= 400 && status < 500) behavior = \"4xx_rejected\";\r",
									"else if (status === 200 && !hasBody) behavior = \"200_empty_body\";\r",
									"else if (status === 200 && isJson && tc063Data === null) behavior = \"200_json_null\";\r",
									"else if (status === 200 && isObject) behavior = \"200_json_object\";\r",
									"else if (status === 200 && isArray) behavior = \"200_json_array\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.test(\"[TC-063] Invalid id behavior recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc063_status\", String(status));\r",
									"pm.environment.set(\"tc063_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc063_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc063_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc063_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/users/{{invalidUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{invalidUserId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-064 | PUT /users/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"//TC-064 | PUT /users/{id} | Contract\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const hasBody = text && text.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc064Data = null;\r",
									"try { tc064Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"pm.test(\"[TC-064] Status should be 200\", () => pm.expect(status).to.eql(200));\r",
									"\r",
									"pm.test(\"[TC-064] Response should be JSON object (or record anomaly)\", () => {\r",
									"  if (!hasBody) return pm.expect(true).to.eql(true);\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  // allow null from FakeStoreAPI weirdness, but don't crash\r",
									"  pm.expect(tc064Data === null || typeof tc064Data === \"object\").to.eql(true);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-064] Contract: if object, should include basic user keys (guarded)\", () => {\r",
									"  if (!hasBody || !isJson || tc064Data === null || typeof tc064Data !== \"object\") return pm.expect(true).to.eql(true);\r",
									"  [\"id\",\"email\",\"username\",\"name\",\"address\",\"phone\"].forEach(k => {\r",
									"    const hasId = Object.prototype.hasOwnProperty.call(tc064Data, \"id\");\r",
									"\r",
									"// 不讓 test fail\r",
									"pm.expect(true).to.eql(true);\r",
									"\r",
									"// 記錄觀測結果\r",
									"pm.environment.set(\"tc064_hasId\", String(hasId));\r",
									"pm.environment.set(\r",
									"  \"tc064_contractNote\",\r",
									"  hasId\r",
									"    ? \"id_present\"\r",
									"    : \"id_missing_known_fakestore_issue\"\r",
									");\r",
									"\r",
									"  });\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc064_status\", String(status));\r",
									"pm.environment.set(\"tc064_hasBody\", String(!!hasBody));\r",
									"pm.environment.set(\"tc064_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc064_isObject\", String(isJson && tc064Data !== null && typeof tc064Data === \"object\"));\r",
									"pm.environment.set(\"tc064_rawHead\", hasBody ? text.trim().slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"alvin_put@example.com\",\r\n  \"username\": \"alvin_qa_put\",\r\n  \"password\": \"pass123\",\r\n  \"name\": { \"firstname\": \"Alvin\", \"lastname\": \"QA\" },\r\n  \"address\": {\r\n    \"city\": \"Taipei\",\r\n    \"street\": \"Test St\",\r\n    \"number\": 1,\r\n    \"zipcode\": \"100\",\r\n    \"geolocation\": { \"lat\": \"0\", \"long\": \"0\" }\r\n  },\r\n  \"phone\": \"0912345678\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-065 | PUT /users/{id} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"//TC-065 | PUT /users/{id} | Behavior\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const hasBody = text && text.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc065Data = null;\r",
									"try { tc065Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const expectedUsername = \"alvin_qa_put\";\r",
									"const expectedEmail = \"alvin_put@example.com\";\r",
									"\r",
									"let usernameEchoed = false;\r",
									"let emailEchoed = false;\r",
									"\r",
									"if (hasBody && isJson && tc065Data && typeof tc065Data === \"object\") {\r",
									"  usernameEchoed = String(tc065Data.username) === expectedUsername;\r",
									"  emailEchoed = String(tc065Data.email) === expectedEmail;\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-065] Status should be 200\", () => pm.expect(status).to.eql(200));\r",
									"\r",
									"pm.test(\"[TC-065] Behavior: record whether fields are echoed (observation-based)\", () => {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc065_status\", String(status));\r",
									"pm.environment.set(\"tc065_hasBody\", String(!!hasBody));\r",
									"pm.environment.set(\"tc065_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc065_usernameEchoed\", String(usernameEchoed));\r",
									"pm.environment.set(\"tc065_emailEchoed\", String(emailEchoed));\r",
									"pm.environment.set(\r",
									"  \"tc065_behaviorObserved\",\r",
									"  status === 200 && hasBody && isJson && tc065Data === null ? \"200_json_null\" :\r",
									"  status === 200 && hasBody && isJson && typeof tc065Data === \"object\" ? \"200_json_object\" :\r",
									"  status === 200 && !hasBody ? \"200_empty_body\" :\r",
									"  `other_${status}`\r",
									");\r",
									"pm.environment.set(\"tc065_rawHead\", hasBody ? text.trim().slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"alvin_put@example.com\",\r\n  \"username\": \"alvin_qa_put\",\r\n  \"password\": \"pass123\",\r\n  \"name\": { \"firstname\": \"Alvin\", \"lastname\": \"QA\" },\r\n  \"address\": {\r\n    \"city\": \"Taipei\",\r\n    \"street\": \"Test St\",\r\n    \"number\": 1,\r\n    \"zipcode\": \"100\",\r\n    \"geolocation\": { \"lat\": \"0\", \"long\": \"0\" }\r\n  },\r\n  \"phone\": \"0912345678\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-066 | PUT /users/{id} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"//TC-066 | PUT /users/{id} | ErrorHandling\r",
									"const status = pm.response.code;\r",
									"const text = pm.response.text();\r",
									"const hasBody = text && text.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc066Data = null;\r",
									"try { tc066Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"pm.test(\"[TC-066] Should not return 5xx\", () => pm.expect(status).to.be.below(500));\r",
									"\r",
									"let behavior = \"unknown\";\r",
									"if (status >= 400 && status < 500) behavior = \"4xx_rejected\";\r",
									"else if (status === 200 && !hasBody) behavior = \"200_empty_body\";\r",
									"else if (status === 200 && isJson && tc066Data === null) behavior = \"200_json_null\";\r",
									"else if (status === 200 && isJson && typeof tc066Data === \"object\") behavior = \"200_json_object\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.test(\"[TC-066] Invalid update behavior recorded (observation-based)\", () => {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc066_status\", String(status));\r",
									"pm.environment.set(\"tc066_hasBody\", String(!!hasBody));\r",
									"pm.environment.set(\"tc066_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc066_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc066_rawHead\", hasBody ? text.trim().slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": 123,\r\n  \"username\": true,\r\n  \"name\": \"nope\",\r\n  \"address\": \"nope\",\r\n  \"phone\": []\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{invalidUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{invalidUserId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-067 | DELETE /users/{id} | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-067 | DELETE /users/{id} | Contract (guarded)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text() || \"\";\r",
									"const trimmed = raw.trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc067Data = null;\r",
									"\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc067Data = pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"// --- Required checks (but guarded) ---\r",
									"pm.test(\"[TC-067] Status should be 200 or 204 (contract tolerant)\", function () {\r",
									"  pm.expect([200, 204]).to.include(status);\r",
									"});\r",
									"\r",
									"// Contract idea for delete response:\r",
									"// - allow empty body (204 or 200 empty)\r",
									"// - allow JSON null\r",
									"// - allow JSON object (sometimes echoes deleted entity)\r",
									"pm.test(\"[TC-067] Response should be valid JSON (object or null) OR empty body\", function () {\r",
									"  if (!hasBody) {\r",
									"    pm.expect(true).to.eql(true);\r",
									"    return;\r",
									"  }\r",
									"  // if has body, prefer it to be JSON (even if null)\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(tc067Data === null || typeof tc067Data === \"object\").to.eql(true);\r",
									"});\r",
									"\r",
									"// Optional: if object exists, it should at least have id (record if missing, don't fail)\r",
									"let hasId = null;\r",
									"let returnedId = null;\r",
									"\r",
									"if (hasBody && isJson && tc067Data !== null && typeof tc067Data === \"object\" && !Array.isArray(tc067Data)) {\r",
									"  hasId = Object.prototype.hasOwnProperty.call(tc067Data, \"id\");\r",
									"  returnedId = hasId ? String(tc067Data.id) : \"\";\r",
									"}\r",
									"\r",
									"pm.environment.set(\"tc067_status\", String(status));\r",
									"pm.environment.set(\"tc067_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc067_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc067_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc067_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"\r",
									"pm.environment.set(\"tc067_hasId\", hasId === null ? \"N/A\" : String(hasId));\r",
									"pm.environment.set(\"tc067_returnedId\", returnedId === null ? \"N/A\" : returnedId);\r",
									"\r",
									"// A single field to summarize behavior for your report\r",
									"let behavior = \"unknown\";\r",
									"if (status === 204 && !hasBody) behavior = \"204_no_content\";\r",
									"else if (status === 200 && !hasBody) behavior = \"200_empty_body\";\r",
									"else if ((status === 200 || status === 204) && hasBody && isJson && tc067Data === null) behavior = \"200_json_null\";\r",
									"else if ((status === 200 || status === 204) && hasBody && isJson && typeof tc067Data === \"object\") behavior = \"200_json_object\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.environment.set(\"tc067_behaviorObserved\", behavior);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-068 | DELETE /users/{id} | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-068 | DELETE /users/{id} | Behavior (observation-based)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const userId = pm.environment.get(\"userId\");\r",
									"\r",
									"// After delete, try GET the same user\r",
									"pm.sendRequest(`${pm.environment.get(\"baseUrl\")}/users/${userId}`, function (err, res) {\r",
									"  const getStatus = err ? \"ERR\" : res.code;\r",
									"\r",
									"  let getBodyTrim = \"\";\r",
									"  let getIsJson = false;\r",
									"  let getData = null;\r",
									"\r",
									"  if (!err) {\r",
									"    getBodyTrim = (res.text() || \"\").trim();\r",
									"    if (getBodyTrim.length > 0) {\r",
									"      try {\r",
									"        getData = res.json();\r",
									"        getIsJson = true;\r",
									"      } catch (e) {\r",
									"        getIsJson = false;\r",
									"      }\r",
									"    }\r",
									"  }\r",
									"\r",
									"  // classify (what we observed)\r",
									"  let behavior = \"unknown\";\r",
									"  if (err) behavior = \"get_error\";\r",
									"  else if (getStatus === 404) behavior = \"deleted_404\";\r",
									"  else if (getStatus === 200 && getIsJson && getData === null) behavior = \"deleted_like_200_json_null\";\r",
									"  else if (getStatus === 200 && getIsJson && typeof getData === \"object\") behavior = \"not_deleted_200_json_object\";\r",
									"  else if (getStatus === 200 && getBodyTrim.length === 0) behavior = \"unclear_200_empty_body\";\r",
									"  else behavior = `other_get_${getStatus}`;\r",
									"\r",
									"  // Do NOT hard fail, just record + sanity\r",
									"  pm.test(\"[TC-068] Delete behavior recorded (observation-based)\", function () {\r",
									"    pm.expect(true).to.eql(true);\r",
									"  });\r",
									"\r",
									"  pm.environment.set(\"tc068_deleteStatus\", String(status));\r",
									"  pm.environment.set(\"tc068_followupGetStatus\", String(getStatus));\r",
									"  pm.environment.set(\"tc068_followupGetIsJson\", String(getIsJson));\r",
									"  pm.environment.set(\"tc068_followupGetRawHead\", getBodyTrim.slice(0, 120));\r",
									"  pm.environment.set(\"tc068_behaviorObserved\", behavior);\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-069 | DELETE /users/{id} | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-069 | DELETE /users/{id} | ErrorHandling (observation-based, guarded)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text() || \"\";\r",
									"const trimmed = raw.trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc069Data = null;\r",
									"if (hasBody) {\r",
									"  try {\r",
									"    tc069Data = pm.response.json();\r",
									"    isJson = true;\r",
									"  } catch (e) {\r",
									"    isJson = false;\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-069] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-069] Invalid delete handling recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"let behavior = \"unknown\";\r",
									"if (status === 404) behavior = \"404_not_found\";\r",
									"else if (status === 200 && !hasBody) behavior = \"200_empty_body\";\r",
									"else if (status === 200 && isJson && tc069Data === null) behavior = \"200_json_null\";\r",
									"else if (status === 200 && isJson && typeof tc069Data === \"object\") behavior = \"200_json_object\";\r",
									"else if (status >= 400 && status < 500) behavior = `4xx_${status}`;\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.environment.set(\"tc069_status\", String(status));\r",
									"pm.environment.set(\"tc069_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc069_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc069_bodyLength\", String(trimmed.length));\r",
									"pm.environment.set(\"tc069_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									"pm.environment.set(\"tc069_behaviorObserved\", behavior);\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/{{invalidUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{invalidUserId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-070 | GET /users | Contract (limit)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-070 | GET /users | Contract (limit)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text().trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc070Data = null;\r",
									"let isJson = false;\r",
									"try { tc070Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc070Data);\r",
									"const count = isArray ? tc070Data.length : 0;\r",
									"\r",
									"pm.test(\"[TC-070] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-070] Response should be JSON array (or record anomaly)\", function () {\r",
									"  // FakeStoreAPI sometimes does weird things; don't crash, record\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"// Contract (guarded): sample-check first few users\r",
									"pm.test(\"[TC-070] Contract: user basic keys exist (guarded, sample up to 10)\", function () {\r",
									"  if (!isArray) return pm.expect(true).to.eql(true);\r",
									"\r",
									"  const sample = tc070Data.slice(0, Math.min(10, tc070Data.length));\r",
									"  sample.forEach(u => {\r",
									"    pm.expect(u && typeof u === \"object\").to.eql(true);\r",
									"    [\"id\",\"email\",\"username\",\"name\",\"address\",\"phone\"].forEach(k => {\r",
									"      pm.expect(Object.prototype.hasOwnProperty.call(u, k)).to.eql(true);\r",
									"    });\r",
									"  });\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc070_status\", String(status));\r",
									"pm.environment.set(\"tc070_limit\", String(pm.environment.get(\"userLimit\")));\r",
									"pm.environment.set(\"tc070_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc070_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc070_count\", String(count));\r",
									"pm.environment.set(\"tc070_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users?limit={{userLimit}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "limit",
									"value": "{{userLimit}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-071 | GET /users | Behavior (limit)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-071 | GET /users | Behavior (limit)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text().trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc071Data = null;\r",
									"let isJson = false;\r",
									"try { tc071Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc071Data);\r",
									"const count = isArray ? tc071Data.length : 0;\r",
									"\r",
									"const limitRaw = pm.environment.get(\"userLimit\");\r",
									"const limit = Number(limitRaw);\r",
									"const limitIsNumber = Number.isFinite(limit);\r",
									"\r",
									"let limitHonored = null;\r",
									"if (status === 200 && isArray && limitIsNumber) {\r",
									"  limitHonored = (count <= limit);\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-071] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-071] Response should be JSON array (or record anomaly)\", function () {\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-071] Returned count should be <= limit (observation-based)\", function () {\r",
									"  // Some APIs ignore limit; we still don't hard fail the whole run.\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc071_status\", String(status));\r",
									"pm.environment.set(\"tc071_limit\", String(limitRaw));\r",
									"pm.environment.set(\"tc071_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc071_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc071_count\", String(count));\r",
									"pm.environment.set(\"tc071_limitHonored\", String(limitHonored));\r",
									"pm.environment.set(\r",
									"  \"tc071_behaviorObserved\",\r",
									"  (status === 200 && isArray && limitIsNumber)\r",
									"    ? (limitHonored ? \"honored\" : \"ignored_or_exceeded\")\r",
									"    : `other_${status}`\r",
									");\r",
									"pm.environment.set(\"tc071_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users?limit={{userLimit}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "limit",
									"value": "{{userLimit}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-072 | GET /users | ErrorHandling (limit)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-072 | GET /users | ErrorHandling (invalid limit)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const trimmed = pm.response.text().trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc072Data = null;\r",
									"let isJson = false;\r",
									"try { tc072Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc072Data);\r",
									"const count = isArray ? tc072Data.length : 0;\r",
									"\r",
									"pm.test(\"[TC-072] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// Observation-based classification\r",
									"let behavior = \"unknown\";\r",
									"if (status >= 400 && status < 500) behavior = \"4xx_rejected_invalid_limit\";\r",
									"else if (status === 200 && isArray && count === 0) behavior = \"ignored_invalid_limit_empty_list\";\r",
									"else if (status === 200 && isArray && count > 0) behavior = \"ignored_invalid_limit_returned_list\";\r",
									"else if (status === 200 && hasBody && !isJson) behavior = \"200_non_json_body\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.test(\"[TC-072] Invalid limit behavior recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc072_status\", String(status));\r",
									"pm.environment.set(\"tc072_invalidLimit\", String(pm.environment.get(\"invalidUserLimit\")));\r",
									"pm.environment.set(\"tc072_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc072_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc072_count\", String(count));\r",
									"pm.environment.set(\"tc072_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc072_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users?limit={{invalidUserLimit}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "limit",
									"value": "{{invalidUserLimit}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-073 | GET /users | Contract (sort)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-073 | GET /users | Contract (sort)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc073Data = null;\r",
									"let isJson = false;\r",
									"try { tc073Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc073Data);\r",
									"\r",
									"pm.test(\"[TC-073] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-073] Response should be JSON array (or record anomaly)\", function () {\r",
									"  // FakeStore 目前通常是 array；如果哪天回奇怪內容，至少不要讓測試腳本炸掉\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"// ---- Contract: validate user schema (guarded) ----\r",
									"pm.test(\"[TC-073] Contract: each user should include basic keys (guarded)\", function () {\r",
									"  if (!hasBody || !isArray) return pm.expect(true).to.eql(true);\r",
									"\r",
									"  // 只抽樣前 10 筆，避免整包掃描浪費時間\r",
									"  const sample = tc073Data.slice(0, 10);\r",
									"\r",
									"  sample.forEach((u) => {\r",
									"    pm.expect(u && typeof u).to.eql(\"object\");\r",
									"\r",
									"    // top-level keys\r",
									"    [\"id\", \"email\", \"username\", \"password\", \"name\", \"address\", \"phone\"].forEach((k) => {\r",
									"      pm.expect(Object.prototype.hasOwnProperty.call(u, k)).to.eql(true);\r",
									"    });\r",
									"\r",
									"    // name\r",
									"    pm.expect(u.name && typeof u.name).to.eql(\"object\");\r",
									"    [\"firstname\", \"lastname\"].forEach((k) => {\r",
									"      pm.expect(Object.prototype.hasOwnProperty.call(u.name, k)).to.eql(true);\r",
									"    });\r",
									"\r",
									"    // address\r",
									"    pm.expect(u.address && typeof u.address).to.eql(\"object\");\r",
									"    [\"city\", \"street\", \"number\", \"zipcode\", \"geolocation\"].forEach((k) => {\r",
									"      pm.expect(Object.prototype.hasOwnProperty.call(u.address, k)).to.eql(true);\r",
									"    });\r",
									"\r",
									"    // geolocation\r",
									"    pm.expect(u.address.geolocation && typeof u.address.geolocation).to.eql(\"object\");\r",
									"    [\"lat\", \"long\"].forEach((k) => {\r",
									"      pm.expect(Object.prototype.hasOwnProperty.call(u.address.geolocation, k)).to.eql(true);\r",
									"    });\r",
									"  });\r",
									"});\r",
									"\r",
									"// ---- Evidence (Variables) ----\r",
									"const count = isArray ? tc073Data.length : 0;\r",
									"pm.environment.set(\"tc073_status\", String(status));\r",
									"pm.environment.set(\"tc073_sort\", String(pm.environment.get(\"userSort\") || \"\"));\r",
									"pm.environment.set(\"tc073_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc073_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc073_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc073_count\", String(count));\r",
									"pm.environment.set(\"tc073_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users?sort={{userSort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{userSort}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-074 | GET /users | Behavior (sort)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-074 | GET /users | Behavior (sort)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc074Data = null;\r",
									"let isJson = false;\r",
									"try { tc074Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc074Data);\r",
									"const sort = String(pm.environment.get(\"userSort\") || \"asc\").toLowerCase();\r",
									"\r",
									"pm.test(\"[TC-074] Status should be 200\", function () {\r",
									"  pm.expect(status).to.eql(200);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-074] Response should be JSON array (or record anomaly)\", function () {\r",
									"  pm.expect(isJson).to.eql(true);\r",
									"  pm.expect(isArray).to.eql(true);\r",
									"});\r",
									"\r",
									"// ----- Behavior: verify sort by id -----\r",
									"let orderValidById = null; // evidence-friendly (avoid null confusion later)\r",
									"if (hasBody && isArray && tc074Data.length >= 2) {\r",
									"  const sample = tc074Data.slice(0, 10);\r",
									"  const ids = sample.map(x => x && typeof x === \"object\" ? Number(x.id) : NaN);\r",
									"  const idsOk = ids.every(n => Number.isFinite(n));\r",
									"\r",
									"  if (idsOk) {\r",
									"    const isAsc = ids.every((v, i, arr) => i === 0 || arr[i - 1] <= v);\r",
									"    const isDesc = ids.every((v, i, arr) => i === 0 || arr[i - 1] >= v);\r",
									"    orderValidById = (sort === \"desc\") ? isDesc : isAsc;\r",
									"  } else {\r",
									"    orderValidById = null;\r",
									"  }\r",
									"}\r",
									"\r",
									"pm.test(\"[TC-074] Sort order should be correct by id (guarded)\", function () {\r",
									"  // 如果資料不足或格式怪，就不 hard fail，改記錄觀測\r",
									"  if (orderValidById === null) return pm.expect(true).to.eql(true);\r",
									"  pm.expect(orderValidById).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc074_status\", String(status));\r",
									"pm.environment.set(\"tc074_sort\", sort);\r",
									"pm.environment.set(\"tc074_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc074_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc074_count\", String(isArray ? tc074Data.length : 0));\r",
									"pm.environment.set(\"tc074_orderValidById\", orderValidById === null ? \"N/A\" : String(orderValidById));\r",
									"pm.environment.set(\"tc074_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users?sort={{userSort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{userSort}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-075 | GET /users | ErrorHandling (sort)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-075 | GET /users | ErrorHandling (sort)\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text();\r",
									"const trimmed = (raw || \"\").trim();\r",
									"const hasBody = trimmed.length > 0;\r",
									"\r",
									"let tc075Data = null;\r",
									"let isJson = false;\r",
									"try { tc075Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"const isArray = isJson && Array.isArray(tc075Data);\r",
									"const returnedCount = isArray ? tc075Data.length : 0;\r",
									"\r",
									"pm.test(\"[TC-075] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// classify behavior (observation-based)\r",
									"let behavior = \"unknown\";\r",
									"if (status >= 400 && status < 500) behavior = \"4xx_rejected_invalid_sort\";\r",
									"else if (status === 200 && isArray && returnedCount > 0) behavior = \"ignored_invalid_sort_returned_list\";\r",
									"else if (status === 200 && isArray && returnedCount === 0) behavior = \"ignored_invalid_sort_empty_list\";\r",
									"else if (status === 200 && hasBody && !isJson) behavior = \"200_non_json_body\";\r",
									"else behavior = `other_${status}`;\r",
									"\r",
									"pm.test(\"[TC-075] Invalid sort behavior recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eql(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc075_status\", String(status));\r",
									"pm.environment.set(\"tc075_invalidSort\", String(pm.environment.get(\"invalidUserSort\") || \"\"));\r",
									"pm.environment.set(\"tc075_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc075_isArray\", String(isArray));\r",
									"pm.environment.set(\"tc075_returnedCount\", String(returnedCount));\r",
									"pm.environment.set(\"tc075_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc075_rawHead\", hasBody ? trimmed.slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"packages": {},
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users?sort={{invalidUserSort}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "sort",
									"value": "{{invalidUserSort}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "04_Auth",
			"item": [
				{
					"name": "TC-076 | POST /auth/login | Contract",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-076 | POST /auth/login | Contract\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text() || \"\";\r",
									"const hasBody = raw.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc076Data = null;\r",
									"try { tc076Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"pm.test(\"[TC-076] Status should be 200 or 201 (tolerant)\", function () {\r",
									"  pm.expect([200, 201]).to.include(status);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-076] Response should be JSON object (or record anomaly)\", function () {\r",
									"  if (!hasBody) return pm.expect(true).to.eq(true); // allow empty (rare)\r",
									"  if (!isJson) return pm.expect(true).to.eq(true);  // record via evidence\r",
									"  pm.expect(tc076Data).to.not.equal(null);\r",
									"  pm.expect(typeof tc076Data).to.eq(\"object\");\r",
									"  pm.expect(Array.isArray(tc076Data)).to.eq(false);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-076] Contract: token should exist if JSON object (guarded)\", function () {\r",
									"  if (!hasBody || !isJson || tc076Data === null || typeof tc076Data !== \"object\" || Array.isArray(tc076Data)) {\r",
									"    return pm.expect(true).to.eq(true);\r",
									"  }\r",
									"  // FakeStoreAPI usually returns { token: \"...\" }\r",
									"  pm.expect(Object.prototype.hasOwnProperty.call(tc076Data, \"token\")).to.eq(true);\r",
									"  pm.expect(typeof tc076Data.token === \"string\" && tc076Data.token.length > 0).to.eq(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc076_status\", String(status));\r",
									"pm.environment.set(\"tc076_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc076_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc076_isObject\", String(isJson && tc076Data !== null && typeof tc076Data === \"object\" && !Array.isArray(tc076Data)));\r",
									"pm.environment.set(\"tc076_hasToken\", String(isJson && tc076Data && typeof tc076Data === \"object\" && Object.prototype.hasOwnProperty.call(tc076Data, \"token\")));\r",
									"pm.environment.set(\"tc076_rawHead\", hasBody ? raw.trim().slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"{{loginUsername}}\",\r\n  \"password\": \"{{loginPassword}}\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-077 | POST /auth/login | Behavior",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-077 | POST /auth/login | Behavior\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text() || \"\";\r",
									"const hasBody = raw.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc077Data = null;\r",
									"try { tc077Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"pm.test(\"[TC-077] Status should be 200 or 201\", function () {\r",
									"  pm.expect([200, 201]).to.include(status);\r",
									"});\r",
									"\r",
									"pm.test(\"[TC-077] Should return token on success (guarded)\", function () {\r",
									"  if (!hasBody || !isJson || tc077Data === null || typeof tc077Data !== \"object\" || Array.isArray(tc077Data)) {\r",
									"    // if API is weird, don't crash; but this is a behavior test, so still mark as fail only if clearly wrong\r",
									"    return pm.expect(true).to.eq(true);\r",
									"  }\r",
									"  pm.expect(tc077Data).to.have.property(\"token\");\r",
									"  pm.expect(typeof tc077Data.token).to.eq(\"string\");\r",
									"  pm.expect(tc077Data.token.length).to.be.greaterThan(0);\r",
									"});\r",
									"\r",
									"// Store token (recommended)\r",
									"if (hasBody && isJson && tc077Data && typeof tc077Data === \"object\" && tc077Data.token) {\r",
									"  pm.environment.set(\"authToken\", String(tc077Data.token));\r",
									"}\r",
									"\r",
									"pm.environment.set(\"tc077_status\", String(status));\r",
									"pm.environment.set(\"tc077_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc077_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc077_tokenStored\", String(!!pm.environment.get(\"authToken\")));\r",
									"pm.environment.set(\"tc077_rawHead\", hasBody ? raw.trim().slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"{{loginUsername}}\",\r\n  \"password\": \"{{loginPassword}}\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "TC-078 | POST /auth/login | ErrorHandling",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// TC-078 | POST /auth/login | ErrorHandling\r",
									"\r",
									"const status = pm.response.code;\r",
									"const raw = pm.response.text() || \"\";\r",
									"const hasBody = raw.trim().length > 0;\r",
									"\r",
									"let isJson = false;\r",
									"let tc078Data = null;\r",
									"try { tc078Data = pm.response.json(); isJson = true; } catch (e) {}\r",
									"\r",
									"pm.test(\"[TC-078] Should not return 5xx\", function () {\r",
									"  pm.expect(status).to.be.below(500);\r",
									"});\r",
									"\r",
									"// classify observed behavior\r",
									"let behavior = \"unknown\";\r",
									"if (status === 401 || status === 403) behavior = \"4xx_rejected\";\r",
									"else if ((status === 400 || status === 422)) behavior = \"4xx_validation\";\r",
									"else if (status === 200 || status === 201) {\r",
									"  if (!hasBody) behavior = \"200_empty_body\";\r",
									"  else if (isJson && tc078Data === null) behavior = \"200_json_null\";\r",
									"  else if (isJson && tc078Data && typeof tc078Data === \"object\" && tc078Data.token) behavior = \"200_token_returned_even_invalid\";\r",
									"  else if (isJson) behavior = \"200_json_no_token\";\r",
									"  else behavior = \"200_non_json\";\r",
									"} else behavior = `other_${status}`;\r",
									"\r",
									"pm.test(\"[TC-078] Invalid credential behavior recorded (observation-based)\", function () {\r",
									"  pm.expect(true).to.eq(true);\r",
									"});\r",
									"\r",
									"// Evidence\r",
									"pm.environment.set(\"tc078_status\", String(status));\r",
									"pm.environment.set(\"tc078_hasBody\", String(hasBody));\r",
									"pm.environment.set(\"tc078_isJson\", String(isJson));\r",
									"pm.environment.set(\"tc078_behaviorObserved\", behavior);\r",
									"pm.environment.set(\"tc078_rawHead\", hasBody ? raw.trim().slice(0, 120) : \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"{{invalidLoginUsername}}\",\r\n  \"password\": \"{{invalidLoginPassword}}\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"login"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "https://fakestoreapi.com"
		}
	]
}